/*! lineupjs - v1.0.0 - 2016
* https://github.com/Caleydo/lineup.js
* Copyright (c) 2016 Caleydo Team; Licensed BSD-3-Clause*/
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("d3")):"function"==typeof define&&define.amd?define(["d3"],e):"object"==typeof exports?exports.LineUpJS=e(require("d3")):t.LineUpJS=e(t.d3)}(this,function(t){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=44)}([function(e,n){e.exports=t},function(t,e,n){"use strict";function r(t){return t.replace(/[\s!#$%&'()*+,.\/:;<=>?@\[\\\]\^`{|}~]/g,"_")}var i=n(2);e.b=r;var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a=function(t){function e(n,i){var o=t.call(this)||this;return o.desc=i,o.width=100,o.parent=null,o.compressed=!1,o.uid=r(n),o.cssClass=o.desc.cssClass||"",o.metadata={label:o.desc.label||o.id,description:o.desc.description||"",color:o.desc.color||(""!==o.cssClass?null:e.DEFAULT_COLOR)},o}return o(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.uid},enumerable:!0,configurable:!0}),e.prototype.assignNewId=function(t){this.uid=r(t())},Object.defineProperty(e.prototype,"label",{get:function(){return this.metadata.label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this.metadata.description},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this.metadata.color},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headerCssClass",{get:function(){return this.desc.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fqid",{get:function(){return this.parent?this.parent.fqid+"_"+this.id:this.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fqpath",{get:function(){return this.parent?this.parent.fqpath+"@"+this.parent.indexOf(this):""},enumerable:!0,configurable:!0}),e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat([e.EVENT_WIDTH_CHANGED,e.EVENT_FILTER_CHANGED,e.EVENT_LABEL_CHANGED,e.EVENT_METADATA_CHANGED,e.EVENT_COMPRESS_CHANGED,e.EVENT_ADD_COLUMN,e.EVENT_REMOVE_COLUMN,e.EVENT_DIRTY,e.EVENT_DIRTY_HEADER,e.EVENT_DIRTY_VALUES])},e.prototype.getWidth=function(){return this.width},e.prototype.isHidden=function(){return this.width<=0},e.prototype.hide=function(){return this.setWidth(0)},e.prototype.setCompressed=function(t){this.compressed!==t&&this.fire([e.EVENT_COMPRESS_CHANGED,e.EVENT_DIRTY_HEADER,e.EVENT_DIRTY_VALUES,e.EVENT_DIRTY],this.compressed,this.compressed=t)},e.prototype.getCompressed=function(){return this.compressed},e.prototype.flatten=function(t,n,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var o=this.compressed?e.COMPRESSED_WIDTH:this.getWidth();return t.push({col:this,offset:n,width:o}),o},e.prototype.setWidth=function(t){this.width!==t&&this.fire([e.EVENT_WIDTH_CHANGED,e.EVENT_DIRTY_HEADER,e.EVENT_DIRTY_VALUES,e.EVENT_DIRTY],this.width,this.width=t)},e.prototype.setWidthImpl=function(t){this.width=t},e.prototype.setMetaData=function(t){if(t.label!==this.label||this.color!==t.color||this.description!==t.description){var n=this.color===t.color?[e.EVENT_LABEL_CHANGED,e.EVENT_METADATA_CHANGED,e.EVENT_DIRTY_HEADER,e.EVENT_DIRTY]:[e.EVENT_LABEL_CHANGED,e.EVENT_METADATA_CHANGED,e.EVENT_DIRTY_HEADER,e.EVENT_DIRTY_VALUES,e.EVENT_DIRTY],r=this.getMetaData();this.metadata={label:t.label,color:t.color,description:t.description},this.fire(n,r,this.getMetaData())}},e.prototype.getMetaData=function(){return{label:this.label,color:this.color,description:this.description}},e.prototype.sortByMe=function(t){void 0===t&&(t=!1);var e=this.findMyRanker();return!!e&&e.sortBy(this,t)},e.prototype.toggleMySorting=function(){var t=this.findMyRanker();return!!t&&t.toggleSorting(this)},e.prototype.removeMe=function(){return!!this.parent&&this.parent.remove(this)},e.prototype.insertAfterMe=function(t){return!!this.parent&&null!=this.parent.insertAfter(t,this)},e.prototype.findMyRanker=function(){return this.parent?this.parent.findMyRanker():null},e.prototype.dump=function(t){var n={id:this.id,desc:t(this.desc),width:this.width,compressed:this.compressed};return this.label!==(this.desc.label||this.id)&&(n.label=this.label),this.color!==(this.desc.color||e.DEFAULT_COLOR)&&this.color&&(n.color=this.color),n},e.prototype.restore=function(t,e){this.width=t.width||this.width,this.metadata={label:t.label||this.label,color:t.color||this.color,description:this.description},this.compressed=t.compressed===!0},e.prototype.getLabel=function(t,e){return""+this.getValue(t,e)},e.prototype.getValue=function(t,e){return""},e.prototype.compare=function(t,e,n,r){return 0},e.prototype.isFiltered=function(){return!1},e.prototype.filter=function(t,e){return null!==t},e.prototype.rendererType=function(){return this.desc.type},e.prototype.toSortingDesc=function(t){return t(this.desc)},e}(i.AEventDispatcher);e.a=a,a.DEFAULT_COLOR="#C1C1C1",a.FLAT_ALL_COLUMNS=-1,a.COMPRESSED_WIDTH=16,a.EVENT_WIDTH_CHANGED="widthChanged",a.EVENT_FILTER_CHANGED="filterChanged",a.EVENT_LABEL_CHANGED="labelChanged",a.EVENT_METADATA_CHANGED="metaDataChanged",a.EVENT_COMPRESS_CHANGED="compressChanged",a.EVENT_ADD_COLUMN="addColumn",a.EVENT_REMOVE_COLUMN="removeColumn",a.EVENT_DIRTY="dirty",a.EVENT_DIRTY_HEADER="dirtyHeader",a.EVENT_DIRTY_VALUES="dirtyValues"},function(t,e,n){"use strict";function r(t,e,n){void 0===e&&(e=100),void 0===n&&(n=this);var r=-1;return function(){for(var i=[],o=0;o<arguments.length;o++)i[o-0]=arguments[o];r>=0&&(clearTimeout(r),r=-1),i.unshift(null===n?this:n),r=setTimeout(t.bind.apply(t,i),e)}}function i(){for(var t=[],e=0;e<arguments.length;e++)t[e-0]=arguments[e];for(var n=null,r=0;r<t.length;r++){var o=t[r],a=Object.keys(o);if(null!==n)for(var s=0;s<a.length;s++){var c=a[s],l=o[c];Object.prototype.toString.call(l)===v&&Object.getPrototypeOf(l)===Object.prototype?(void 0===n[c]&&(n[c]={}),n[c]=i(n[c],l)):Array.isArray(l)?(void 0===n[c]&&(n[c]=[]),n[c]=l.concat(n[c])):n[c]=l}else n=o}return n}function o(t){var e=t.getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:e.width,height:e.height}}function a(t,e){var n=t.dataTransfer.types;return"function"==typeof n.indexOf?e.some(function(t){return n.indexOf(t)>=0}):"function"==typeof n.includes?e.some(function(t){return n.includes(t)}):"function"==typeof n.contains&&e.some(function(t){return n.contains(t)})}function s(t){var e=t.dataTransfer;return t.ctrlKey&&null!=e.effectAllowed.match(/copy/gi)||null==e.effectAllowed.match(/move/gi)}function c(t){var e=t.dataTransfer;s(t)?e.dropEffect="copy":e.dropEffect="move"}function l(t,e){return function(r){r.on("dragenter",function(){var e=f.event;return a(e,t)?(n.i(f.select)(this).classed("drag_over",!0),!1):void n.i(f.select)(this).classed("drag_over",!1)}).on("dragover",function(){var e=f.event;if(a(e,t))return e.preventDefault(),c(e),n.i(f.select)(this).classed("drag_over",!0),!1}).on("dragleave",function(){n.i(f.select)(this).classed("drag_over",!1)}).on("drop",function(r){var i=f.event;if(i.preventDefault(),n.i(f.select)(this).classed("drag_over",!1),a(i,t)){var o={};return t.forEach(function(t){var e=i.dataTransfer.getData(t);""!==e&&(o[t]=e)}),e(o,r,s(i))}})}}function u(t,e,n){return void 0===e&&(e={}),void 0===n&&(n={}),Object.keys(e).forEach(function(n){return t.setAttribute(n,String(e[n]))}),Object.keys(n).forEach(function(e){return t.style.setProperty(e,n[e])}),t}function p(t,e,n){Array.prototype.slice.call(t.querySelectorAll(e)).forEach(n)}function h(t,e){var n=t.font;t.font=e;var r="abcdefghijklmnopqrstuvwxyz",i=r+r.toUpperCase()+"0123456789",o={maxLetterWidth:t.measureText("M").width,avgLetterWidth:t.measureText(i).width/i.length,ellipsisWidth:t.measureText(m).width};return t.font=n,o}function d(t,e,n,r,i,o){var a=function(e){return t.fillText(e,n,r,i)};if(o.maxLetterWidth*e.length<=i||i<=o.ellipsisWidth||0===e.length)return a(e);if(t.measureText(e).width<=i)return a(e);for(var s=i-o.ellipsisWidth,c=0,l=e.length-1,u=Math.min(l,Math.floor(i/o.avgLetterWidth));c<l;){var p=s-t.measureText(e.substring(0,u+1)).width;if(p<0)l=u-1;else{if(!(p>0))break;c=u+1}u=Math.floor((l+c)/2)}return a(e.substring(0,c+1)+m)}var f=n(0);n.n(f);Object.defineProperty(e,"__esModule",{value:!0}),e.delayedCall=r,n.d(e,"AEventDispatcher",function(){return E}),e.merge=i,e.offset=o,n.d(e,"ContentScroller",function(){return y}),e.hasDnDType=a,e.copyDnD=s,e.updateDropEffect=c,e.dropAble=l,e.attr=u,e.forEach=p,e.createTextHints=h,e.clipText=d;var g=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},E=function(){function t(){this.listeners=f.dispatch.apply(void 0,this.createEventList());var t=this;this.forwarder=function(){for(var e=[],n=0;n<arguments.length;n++)e[n-0]=arguments[n];t.fire.apply(t,[this.type].concat(e))}}return t.prototype.on=function(t,e){var n=this;return arguments.length>1?(Array.isArray(t)?t.forEach(function(t){return n.listeners.on(t,e)}):this.listeners.on(t,e),this):this.listeners.on(t)},t.prototype.createEventList=function(){return[]},t.prototype.fire=function(t){for(var e=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var i=function(t){var r={source:e,type:t,args:n};e.listeners[t].apply(r,n)};Array.isArray(t)?t.forEach(i.bind(this)):i(t)},t.prototype.forward=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t.on(e,this.forwarder)},t.prototype.unforward=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t.on(e,null)},t}(),v="[object Object]",y=function(t){function e(e,r,a){void 0===a&&(a={});var s=t.call(this)||this;return s.container=e,s.content=r,s.options={topShift:function(){return 0},backupRows:5,rowHeight:10},s.prevScrollTop=0,s.shift=0,i(s.options,a),n.i(f.select)(e).on("scroll.scroller",function(){return s.onScroll()}),s.prevScrollTop=e.scrollTop,s.shift=o(r).top-o(e).top,s}return g(e,t),e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat([e.EVENT_REDRAW,e.EVENT_SCROLL])},e.prototype.scrollIntoView=function(t,e,n,r){var i=this.selectImpl(t,e,r,0);if(!(i.from<=n&&n<=i.to)){var o=r(n)-10,a=0,s=this.container.scrollHeight-this.container.clientHeight;this.container.scrollTop=Math.max(a,Math.min(s,o))}},e.prototype.select=function(t,e,n){return this.selectImpl(t,e,n,this.options.backupRows)},e.prototype.selectImpl=function(t,e,n,r){var i,o=this.container.scrollTop-this.shift-this.options.topShift(),a=o+this.container.clientHeight,s=0;if(o>0){for(s=Math.round(o/this.options.rowHeight);s>=t&&n(s+1)>o;)s--;s-=r}for(i=Math.round(a/this.options.rowHeight);i<=e&&n(i-1)<a;)i++;return i+=r,{from:Math.max(s,t),to:Math.min(i,e)}},e.prototype.onScroll=function(){var t=this.container.scrollTop,n=this.container.scrollLeft;this.fire(e.EVENT_SCROLL,t,n),Math.abs(this.prevScrollTop-t)>=this.options.rowHeight*this.options.backupRows&&(this.prevScrollTop=t,this.fire(e.EVENT_REDRAW))},e.prototype.destroy=function(){n.i(f.select)(this.container).on("scroll.scroller",null)},e}(E);y.EVENT_SCROLL="scroll",y.EVENT_REDRAW="redraw";var m="…"},function(t,e,n){"use strict";var r=n(1),i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.accessor=n.accessor||function(){return null},r}return i(e,t),e.prototype.getLabel=function(t,e){return""+this.getValue(t,e)},e.prototype.getRaw=function(t,e){return this.accessor(t,e,this.id,this.desc,this.findMyRanker())},e.prototype.getValue=function(t,e){return this.getRaw(t,e)},e}(r.a);e.a=o},function(t,e,n){"use strict";function r(t){return t instanceof p.a&&"function"==typeof t.getNumber||!(t instanceof p.a)&&null!=t.type.match(/(number|stack|ordinal)/)}function i(t){return"undefined"==typeof t||null==t||isNaN(t)||""===t||"NA"===t||"string"==typeof t&&"na"===t.toLowerCase()}function o(t,e){return isNaN(t)?isNaN(e)?0:1:isNaN(e)?-1:t-e}function a(t){switch(void 0===t&&(t="linear"),t){case"log":return u.scale.log().clamp(!0);case"sqrt":return u.scale.sqrt().clamp(!0);case"pow1.1":return u.scale.pow().exponent(1.1).clamp(!0);case"pow2":return u.scale.pow().exponent(2).clamp(!0);case"pow3":return u.scale.pow().exponent(3).clamp(!0);default:return u.scale.linear().clamp(!0)}}function s(t,e){return t.length===e.length&&t.every(function(t,n){return t===e[n]})}function c(t,e){return"log"===e&&0===t[0]&&(t[0]=1e-7),t}function l(t){if("script"===t.type){var e=new g;return e.restore(t),e}var n=new f;return n.restore(t),n}var u=n(0),p=(n.n(u),n(1)),h=n(3);e.a=r,e.b=o,n.d(e,"d",function(){return f}),n.d(e,"e",function(){return g}),e.f=l;var d=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},f=function(){function t(t,e,n){void 0===t&&(t=[0,1]),void 0===e&&(e="linear"),void 0===n&&(n=[0,1]),this.type=e,this.s=a(e).domain(c(t,this.type)).range(n)}return Object.defineProperty(t.prototype,"domain",{get:function(){return this.s.domain()},set:function(t){this.s.domain(c(t,this.type))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"range",{get:function(){return this.s.range()},set:function(t){this.s.range(t)},enumerable:!0,configurable:!0}),t.prototype.apply=function(t){return this.s(t)},Object.defineProperty(t.prototype,"scaleType",{get:function(){return this.type},enumerable:!0,configurable:!0}),t.prototype.dump=function(){return{type:this.type,domain:this.domain,range:this.range}},t.prototype.eq=function(e){if(!(e instanceof t))return!1;var n=e;return n.type===this.type&&s(this.domain,n.domain)&&s(this.range,n.range)},t.prototype.restore=function(t){this.type=t.type,this.s=a(t.type).domain(t.domain).range(t.range)},t.prototype.clone=function(){return new t(this.domain,this.type,this.range)},t}(),g=function(){function t(t,e){void 0===t&&(t=[0,1]),void 0===e&&(e="return this.linear(value,this.value_min,this.value_max);"),this.domain_=t,this.code_=e,this.f=new Function("value",e)}return Object.defineProperty(t.prototype,"domain",{get:function(){return this.domain_},set:function(t){this.domain_=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"code",{get:function(){return this.code_},set:function(t){this.code_!==t&&(this.code_=t,this.f=new Function("value",t))},enumerable:!0,configurable:!0}),t.prototype.apply=function(t){var e=this.domain_[0],n=this.domain_[this.domain_.length-1],r=this.f.call({value_min:e,value_max:n,value_range:n-e,value_domain:this.domain_.slice(),linear:function(t,e,n){return(t-e)/(n-e)}},t);return"number"==typeof r?Math.max(Math.min(r,1),0):NaN},t.prototype.dump=function(){return{type:"script",code:this.code}},t.prototype.eq=function(e){if(!(e instanceof t))return!1;var n=e;return n.code===this.code},t.prototype.restore=function(t){this.code=t.code},t.prototype.clone=function(){return new t(this.domain,this.code)},t}(),E=function(t){function e(r,i){var o=t.call(this,r,i)||this;return o.missingValue=0,o.currentFilter=e.noFilter(),o.numberFormat=n.i(u.format)(".3n"),i.map?o.mapping=l(i.map):i.domain&&(o.mapping=new f(i.domain,"linear",i.range||[0,1])),o.original=o.mapping.clone(),i.numberFormat&&(o.numberFormat=n.i(u.format)(i.numberFormat)),o}return d(e,t),e.prototype.dump=function(e){var n=t.prototype.dump.call(this,e);return n.map=this.mapping.dump(),n.filter=this.currentFilter,n.missingValue=this.missingValue,n},e.prototype.restore=function(e,r){t.prototype.restore.call(this,e,r),e.map?this.mapping=l(e.map):e.domain&&(this.mapping=new f(e.domain,"linear",e.range||[0,1])),e.currentFilter&&(this.currentFilter=e.currentFilter),e.missingValue&&(this.missingValue=e.missingValue),e.numberFormat&&(this.numberFormat=n.i(u.format)(e.numberFormat))},e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat([e.EVENT_MAPPING_CHANGED])},e.prototype.getLabel=function(e,n){if(this.desc.numberFormat){var r=this.getRawValue(e,n);return isNaN(r)?"NaN":this.numberFormat(r)}var i=t.prototype.getValue.call(this,e,n);return"number"==typeof i?this.numberFormat(+i):String(i)},e.prototype.getRawValue=function(e,n){var r=t.prototype.getValue.call(this,e,n);return i(r)?this.missingValue:+r},e.prototype.getValue=function(t,e){var n=this.getRawValue(t,e);return isNaN(n)?n:this.mapping.apply(n)},e.prototype.getNumber=function(t,e){return this.getValue(t,e)},e.prototype.compare=function(t,e,n,r){return o(this.getValue(t,n),this.getValue(e,r))},e.prototype.getOriginalMapping=function(){return this.original.clone()},e.prototype.getMapping=function(){return this.mapping.clone()},e.prototype.setMapping=function(t){this.mapping.eq(t)||this.fire([e.EVENT_MAPPING_CHANGED,p.a.EVENT_DIRTY_VALUES,p.a.EVENT_DIRTY],this.mapping.clone(),this.mapping=t)},e.prototype.isFiltered=function(){return this.currentFilter.filterMissing||isFinite(this.currentFilter.min)||isFinite(this.currentFilter.max)},Object.defineProperty(e.prototype,"filterMin",{get:function(){return this.currentFilter.min},set:function(t){var e=this.getFilter();this.currentFilter.min=isNaN(t)?-(1/0):t,this.fire([p.a.EVENT_FILTER_CHANGED,p.a.EVENT_DIRTY_VALUES,p.a.EVENT_DIRTY],e,this.getFilter())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filterMax",{get:function(){return this.currentFilter.max},set:function(t){var e=this.getFilter();this.currentFilter.max=isNaN(t)?1/0:t,this.fire([p.a.EVENT_FILTER_CHANGED,p.a.EVENT_DIRTY_VALUES,p.a.EVENT_DIRTY],e,this.getFilter())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filterMissing",{get:function(){return this.currentFilter.filterMissing},set:function(t){var e=this.getFilter();this.currentFilter.filterMissing=t,this.fire([p.a.EVENT_FILTER_CHANGED,p.a.EVENT_DIRTY_VALUES,p.a.EVENT_DIRTY],e,this.getFilter())},enumerable:!0,configurable:!0}),e.prototype.getFilter=function(){return{min:this.currentFilter.min,max:this.currentFilter.max,filterMissing:this.currentFilter.filterMissing}},e.prototype.setFilter=function(t){if(void 0===t&&(t={min:-(1/0),max:+(1/0),filterMissing:!1}),this.currentFilter.min!==t.min||this.currentFilter.max!==t.max||this.currentFilter.filterMissing!==t.filterMissing){var e=this.getFilter();this.currentFilter.min=isNaN(t.min)?-(1/0):t.min,this.currentFilter.max=isNaN(t.max)?1/0:t.max,this.currentFilter.filterMissing=t.filterMissing,this.fire([p.a.EVENT_FILTER_CHANGED,p.a.EVENT_DIRTY_VALUES,p.a.EVENT_DIRTY],e,this.getFilter())}},e.prototype.filter=function(e,n){if(!this.isFiltered())return!0;var r=t.prototype.getValue.call(this,e,n);if(i(r))return!this.filterMissing;var o=+r;return!(isFinite(this.currentFilter.min)&&o<this.currentFilter.min||isFinite(this.currentFilter.max)&&o>this.currentFilter.max)},e.prototype.rendererType=function(){return this.getCompressed()?e.COMPRESSED_RENDERER:t.prototype.rendererType.call(this)},e}(h.a);e.c=E,E.EVENT_MAPPING_CHANGED="mappingChanged",E.COMPRESSED_RENDERER="heatmap",E.noFilter=function(){return{min:-(1/0),max:1/0,filterMissing:!1}}},function(t,e,n){"use strict";var r=n(1),i=n(3),o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.currentFilter=null,r._alignment="left",r.setWidthImpl(200),r._alignment=n.alignment||"left",r}return o(e,t),Object.defineProperty(e.prototype,"alignment",{get:function(){return this._alignment},enumerable:!0,configurable:!0}),e.prototype.getValue=function(e,n){var r=t.prototype.getValue.call(this,e,n);return"undefined"==typeof r||null==r?"":String(r)},e.prototype.dump=function(e){var n=t.prototype.dump.call(this,e);return this.currentFilter instanceof RegExp?n.filter="REGEX:"+this.currentFilter.source:n.filter=this.currentFilter,n.alignment=this.alignment,n},e.prototype.restore=function(e,n){t.prototype.restore.call(this,e,n),e.filter&&"REGEX:"===e.filter.slice(0,6)?this.currentFilter=new RegExp(e.filter.slice(6)):this.currentFilter=e.filter||null,this._alignment=e.alignment||this._alignment},e.prototype.isFiltered=function(){return null!=this.currentFilter},e.prototype.filter=function(t,n){if(!this.isFiltered())return!0;var r=this.getLabel(t,n),i=this.currentFilter;return i===e.FILTER_MISSING?null!=r&&""!==r.trim():"string"==typeof i&&i.length>0?r&&r.toLowerCase().indexOf(i.toLowerCase())>=0:!(i instanceof RegExp)||r&&i.test(r)},e.prototype.getFilter=function(){return this.currentFilter},e.prototype.setFilter=function(t){""===t&&(t=null),this.currentFilter!==t&&this.fire([r.a.EVENT_FILTER_CHANGED,r.a.EVENT_DIRTY_VALUES,r.a.EVENT_DIRTY],this.currentFilter,this.currentFilter=t)},e.prototype.compare=function(t,e,n,r){var i,o;return""===(i=this.getValue(t,n))?""===this.getValue(e,r)?0:1:""===(o=this.getValue(e,r))?-1:i.localeCompare(o)},e}(i.a);e.a=a,a.FILTER_MISSING="__FILTER_MISSING"},function(t,e,n){"use strict";function r(t,e,r){var i=r.getNumber(t,e);isNaN(i)&&(i=0);var o=n.i(d.hsl)(r.color||p.a.DEFAULT_COLOR);return o.l=i,o.toString()}function i(t,e,n){var r=document.querySelector("div.lu-overlay#O"+t);return r||(r=document.createElement("div"),r.classList.add("lu-overlay"),r.id="O"+t,document.querySelector(".lu-body").appendChild(r)),r.style.display="block",r.style.left=e+"px",r.style.top=n+"px",r}function o(){n.i(h.forEach)(document.querySelector("div.lu-body"),"div.lu-overlay",function(t){return t.style.display=null})}function a(t,e,n){function r(e,n){var r=t.childElementCount<=n?null:t.childNodes[n];return null!=r&&r.getAttribute("data-column-id")===e.column.id&&r.getAttribute("data-renderer")===e.column.rendererType()}if(void 0===n&&(n="svg"),0===t.childElementCount)return t.innerHTML=e.map(function(t){return t.renderer.template}).join(""),void e.forEach(function(e,n){var r=t.childNodes[n];r.setAttribute("data-column-id",e.column.id),r.setAttribute("data-renderer",e.column.rendererType())});if(!e.every(r)){var i=new Set(e.map(function(t){return t.column.id+"@"+t.column.rendererType()}));Array.prototype.slice.call(t.childNodes).forEach(function(e){var n=e.getAttribute("data-column-id"),r=e.getAttribute("data-renderer"),o=n+"@"+r;i.has(o)||t.removeChild(e)});var o="svg"===n?document.createElementNS("http://www.w3.org/2000/svg","g"):document.createElement("div");e.forEach(function(e){var n=t.querySelector('[data-column-id="'+e.column.id+'"]');n||(o.innerHTML=e.renderer.template,n=o.childNodes[0],n.setAttribute("data-column-id",e.column.id),n.setAttribute("data-renderer",e.column.rendererType())),t.appendChild(n)})}}function s(t,e){var n=e[t.rendererType()];return n||D}function c(t,e,n){var r=s(t,e);return(r.createSVG?r.createSVG.bind(r):D.createSVG.bind(r))(t,n)}function l(t,e,n){var r=s(t,e);return(r.createHTML?r.createHTML.bind(r):D.createHTML.bind(r))(t,n)}function u(t,e,n){var r=s(t,e);return(r.createCanvas?r.createCanvas.bind(r):D.createCanvas.bind(r))(t,n)}var p=n(1),h=n(2),d=n(0);n.n(d);Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"DefaultCellRenderer",function(){return f}),n.d(e,"BarCellRenderer",function(){return g}),e.hideOverlays=o,n.d(e,"CategoricalCellRenderer",function(){return b}),e.matchColumns=a,n.d(e,"defaultCellRenderer",function(){return D}),n.d(e,"renderers",function(){return C}),e.createSVG=c,e.createHTML=l,e.createCanvas=u;var f=function(){function t(t,e){void 0===t&&(t="text"),void 0===e&&(e="left"),this.textClass=t,this.align=e}return t.prototype.createSVG=function(t,e){var r=this;return{template:'<text class="'+this.textClass+'" clip-path="url(#cp'+e.idPrefix+"clipCol"+t.id+')"></text>',update:function(e,i){var o=2;"right"===r.align?o=t.getWidth()-5:"center"===r.align&&(o=.5*t.getWidth()),n.i(h.attr)(e,{x:o}),e.textContent=t.getLabel(i.v,i.dataIndex)}}},t.prototype.createHTML=function(t,e){return{template:'<div class="'+this.textClass+" "+this.align+'"></div>',update:function(e,r){n.i(h.attr)(e,{},{width:t.getWidth()+"px"}),e.textContent=t.getLabel(r.v,r.dataIndex)}}},t.prototype.createCanvas=function(t,e){var r=this;return function(i,o){var a=i.textAlign;i.textAlign=r.align;var s=t.getWidth(),c=0;"center"===r.align?c=s/2:"right"===r.align&&(c=s),n.i(h.clipText)(i,t.getLabel(o.v,o.dataIndex),c,0,s,e.textHints),i.textAlign=a}},t}(),g=function(){function t(t,e){void 0===t&&(t=!1),void 0===e&&(e=function(t,e,n){return n.color}),this.colorOf=e,this.renderValue=!1,this.renderValue=t}return t.prototype.createSVG=function(t,e){var r=this,i=e.option("rowPadding",1);return{template:'<g class="bar">\n          <rect class="'+t.cssClass+'" y="'+i+'" style="fill: '+t.color+'">\n            <title></title>\n          </rect>\n          <text class="number '+(this.renderValue?"":"hoverOnly")+'" clip-path="url(#cp'+e.idPrefix+"clipCol"+t.id+')"></text>\n        </g>',update:function(o,a,s){o.querySelector("rect title").textContent=t.getLabel(a.v,a.dataIndex);var c=t.getWidth()*t.getValue(a.v,a.dataIndex);n.i(h.attr)(o.querySelector("rect"),{y:i,width:isNaN(c)?0:c,height:e.rowHeight(s)-2*i},{fill:r.colorOf(a.v,s,t)}),n.i(h.attr)(o.querySelector("text"),{}).textContent=t.getLabel(a.v,a.dataIndex)}}},t.prototype.createHTML=function(t,e){var r=this,i=e.option("rowPadding",1);return{template:'<div class="bar" style="top:'+i+"px; background-color: "+t.color+'">\n          <span class="number '+(this.renderValue?"":"hoverOnly")+'"></span>\n        </div>',update:function(o,a,s){var c=t.getWidth()*t.getValue(a.v,a.dataIndex);n.i(h.attr)(o,{title:t.getLabel(a.v,a.dataIndex)},{width:(isNaN(c)?0:c)+"px",height:e.rowHeight(s)-2*i+"px",top:i+"px","background-color":r.colorOf(a.v,s,t)}),o.querySelector("span").textContent=t.getLabel(a.v,a.dataIndex)}}},t.prototype.createCanvas=function(t,e){var r=this,i=e.option("rowPadding",1);return function(o,a,s){o.fillStyle=r.colorOf(a.v,s,t);var c=t.getWidth()*t.getValue(a.v,a.dataIndex);o.fillRect(i,i,isNaN(c)?0:c,e.rowHeight(s)-2*i),(r.renderValue||e.hovered(a.dataIndex)||e.selected(a.dataIndex))&&(o.fillStyle=e.option("style.text","black"),n.i(h.clipText)(o,t.getLabel(a.v,a.dataIndex),1,0,t.getWidth()-1,e.textHints))}},t}(),E={createSVG:function(t,e){var i=e.option("rowPadding",1);return{template:'<rect class="heatmap '+t.cssClass+'" y="'+i+'" style="fill: '+t.color+'">\n            <title></title>\n          </rect>',update:function(o,a,s){o.querySelector("title").textContent=t.getLabel(a.v,a.dataIndex);var c=e.rowHeight(s)-2*i;n.i(h.attr)(o,{y:i,width:c,height:c},{fill:r(a.v,a.dataIndex,t)})}}},createHTML:function(t,e){var i=e.option("rowPadding",1);return{template:'<div class="heatmap '+t.cssClass+'" style="background-color: '+t.color+"; top: "+i+'"></div>',update:function(o,a,s){var c=e.rowHeight(s)-2*i;n.i(h.attr)(o,{title:t.getLabel(a.v,a.dataIndex)},{width:c+"px",height:c+"px",top:i+"px","background-color":r(a.v,a.dataIndex,t)})}}},createCanvas:function(t,e){var n=e.option("rowPadding",1);return function(i,o,a){var s=e.rowHeight(a)-2*n;i.fillStyle=r(o.v,o.dataIndex,t),i.fillRect(n,n,s,s)}}},v={createSVG:function(t,e){var r=e.option("actions",[]);return{template:'<text class="actions hoverOnly fa">'+r.map(function(t){return"<tspan>"+t.icon+"></tspan>"})+"</text>",update:function(t,e){n.i(h.forEach)(t,"tspan",function(t,n){t.onclick=function(t){t.preventDefault(),t.stopPropagation(),r[n].action(e.v,e.dataIndex)}})}}},createHTML:function(t,e){var r=e.option("actions",[]);return{template:'<div class="actions hoverOnly">'+r.map(function(t){return'<span title="'+t.name+'" class="fa">'+t.icon+"></span>"})+"</div>",update:function(t,e){n.i(h.forEach)(t,"span",function(t,n){t.onclick=function(t){t.preventDefault(),t.stopPropagation(),r[n].action(e.v,e.dataIndex)}})}}},createCanvas:function(t,e){var r=e.option("actions",[]);return function(o,a,s,c,l){var u=e.hovered(a.dataIndex);if(u){var p=i(e.idPrefix+t.id,c,l);p.style.width=t.getWidth()+"px",p.classList.add("actions"),p.innerHTML=r.map(function(t){return'<span title="'+t.name+'" class="fa">'+t.icon+"</span>"}).join(""),n.i(h.forEach)(p,"span",function(t,e){t.onclick=function(t){t.preventDefault(),t.stopPropagation(),r[e].action(a.v,a.dataIndex)}})}}}},y={createSVG:function(t){return{template:'<text class="selection fa"><tspan class="selectionOnly"></tspan><tspan class="notSelectionOnly"></tspan></text>',update:function(e,n){e.onclick=function(e){e.preventDefault(),e.stopPropagation(),t.toggleValue(n.v,n.dataIndex)}}}},createHTML:function(t){return{template:'<div class="selection fa"></div>',update:function(e,n){e.onclick=function(e){e.preventDefault(),e.stopPropagation(),t.toggleValue(n.v,n.dataIndex)}}}},createCanvas:function(t,e){return function(r,i){var o=r.font;r.font="10pt FontAwesome",n.i(h.clipText)(r,t.getValue(i.v,i.dataIndex)?"":"",0,0,t.getWidth(),e.textHints),r.font=o}}},m={createSVG:function(t,e){return{template:'<g class="annotations">\n        <text class="notHoverOnly text" clip-path="url(#cp'+e.idPrefix+"clipCol"+t.id+')"></text>\n        <foreignObject class="hoverOnly" x="-2" y="-2">\n          <input type="text">\n        </foreignObject>\n       </g>',update:function(n,r,i){var o=n.querySelector("foreignObject *");o.onchange=function(){t.setValue(r.v,r.dataIndex,this.value)},o.onclick=function(t){t.stopPropagation()},o.style.width=t.getWidth()+"px",o.value=t.getLabel(r.v,r.dataIndex),n.querySelector("text").textContent=t.getLabel(r.v,r.dataIndex);var a=n.querySelector("foreignObject");a.setAttribute("width",String(t.getWidth())),a.setAttribute("height",String(e.rowHeight(i)))}}},createHTML:function(t){return{template:'<div class="annotations text">\n        <input type="text" class="hoverOnly">\n        <span class="text notHoverOnly"></span>\n       </div>',update:function(e,n){var r=e.querySelector("input");r.onchange=function(){t.setValue(n.v,n.dataIndex,this.value)},r.onclick=function(t){t.stopPropagation()},e.style.width=r.style.width=t.getWidth()+"px",r.value=t.getLabel(n.v,n.dataIndex),e.querySelector("span").textContent=t.getLabel(n.v,n.dataIndex)}}},createCanvas:function(t,e){return function(r,o,a,s,c){var l=e.hovered(o.dataIndex);if(l){var u=i(e.idPrefix+t.id,s,c);u.style.width=t.getWidth()+"px",u.innerHTML='<input type="text" value="'+t.getValue(o.v,o.dataIndex)+'" style="width:'+t.getWidth()+'px">';var p=u.childNodes[0];p.onchange=function(){t.setValue(o.v,o.dataIndex,this.value)},p.onclick=function(t){t.stopPropagation()}}else n.i(h.clipText)(r,t.getLabel(o.v,o.dataIndex),0,0,t.getWidth(),e.textHints)}}},_={createSVG:function(t,e){return{template:'<text class="link text" clip-path="url(#cp'+e.idPrefix+"clipCol"+t.id+')"></text>',update:function(e,n){e.innerHTML=t.isLink(n.v,n.dataIndex)?'<a class="link" xlink:href="'+t.getValue(n.v,n.dataIndex)+'" target="_blank">'+t.getLabel(n.v,n.dataIndex)+"</a>":t.getLabel(n.v,n.dataIndex)}}},createHTML:function(t){return{template:'<div class="link text"></div>',update:function(e,n){e.style.width=t.getWidth()+"px",e.innerHTML=t.isLink(n.v,n.dataIndex)?'<a class="link" href="'+t.getValue(n.v,n.dataIndex)+'" target="_blank">'+t.getLabel(n.v,n.dataIndex)+"</a>":t.getLabel(n.v,n.dataIndex)}}},createCanvas:function(t,e){return function(r,o,a,s,c){var l=t.isLink(o.v,o.dataIndex);if(!l)return void n.i(h.clipText)(r,t.getLabel(o.v,o.dataIndex),0,0,t.getWidth(),e.textHints);var u=e.hovered(o.dataIndex);
if(u){var p=i(e.idPrefix+t.id,s,c);p.style.width=t.getWidth()+"px",p.innerHTML='<a class="link" href="'+t.getValue(o.v,o.dataIndex)+'" target="_blank">'+t.getLabel(o.v,o.dataIndex)+"</a>"}else{var d=r.fillStyle;r.fillStyle=e.option("style.link",e.option("style.text","black")),n.i(h.clipText)(r,t.getLabel(o.v,o.dataIndex),0,0,t.getWidth(),e.textHints),r.fillStyle=d}}}},T=function(){function t(){this.alignments={left:new f,right:new f("text_right","right"),center:new f("text_center","center")}}return t.prototype.createSVG=function(t,e){return this.alignments[t.alignment].createSVG(t,e)},t.prototype.createHTML=function(t,e){return this.alignments[t.alignment].createHTML(t,e)},t.prototype.createCanvas=function(t,e){return this.alignments[t.alignment].createCanvas(t,e)},t}(),b=function(){function t(t){void 0===t&&(t="cat"),this.textClass="cat",this.textClass=t}return t.prototype.createSVG=function(t,e){var r=e.option("rowPadding",1);return{template:'<g class="'+this.textClass+'">\n        <text clip-path="url(#cp'+e.idPrefix+"clipCol"+t.id+')"></text>\n        <rect y="'+r+'"></rect>\n      </g>',update:function(i,o,a){var s=Math.max(e.rowHeight(a)-2*r,0);n.i(h.attr)(i.querySelector("rect"),{width:s,height:s},{fill:t.getColor(o.v,o.dataIndex)}),n.i(h.attr)(i.querySelector("text"),{x:e.rowHeight(a)}).textContent=t.getLabel(o.v,o.dataIndex)}}},t.prototype.createHTML=function(t,e){var r=e.option("rowPadding",1);return{template:'<div class="'+this.textClass+'">\n        <div></div>\n        <span></span>\n      </div>',update:function(i,o,a){var s=Math.max(e.rowHeight(a)-2*r,0);n.i(h.attr)(i,{},{width:t.getWidth()+"px"}),n.i(h.attr)(i.querySelector("div"),{},{width:s+"px",height:s+"px","background-color":t.getColor(o.v,o.dataIndex)}),n.i(h.attr)(i.querySelector("span"),{}).textContent=t.getLabel(o.v,o.dataIndex)}}},t.prototype.createCanvas=function(t,e){var r=e.option("rowPadding",1);return function(i,o,a){var s=Math.max(e.rowHeight(a)-2*r,0);i.fillStyle=t.getColor(o.v,o.dataIndex),i.fillRect(0,0,s,s),i.fillStyle=e.option("style.text","black"),n.i(h.clipText)(i,t.getLabel(o.v,o.dataIndex),s+2,0,t.getWidth()-s-2,e.textHints)}},t}(),N=function(){function t(t){void 0===t&&(t=!0),this.nestingPossible=t}return t.prototype.createData=function(t,e){var n=this.nestingPossible&&e.option("stacked",!0),r=e.option("columnPadding",0),i=0;return t.children.map(function(t){var o=i;return i+=t.getWidth(),i+=n?0:r,{column:t,shift:o,stacked:n,renderer:e.renderer(t)}})},t.prototype.createSVG=function(t,e){var n=this.createData(t,e);return{template:'<g class="stack component'+e.option("stackLevel",0)+'">'+n.map(function(t){return t.renderer.template}).join("")+"</g>",update:function(t,e,r){var i=0;a(t,n),n.forEach(function(n,o){var a=t.childNodes[o];a.setAttribute("transform","translate("+(n.shift-i)+",0)"),n.renderer.update(a,e,r),n.stacked&&(i+=n.column.getWidth()*(1-n.column.getValue(e.v,e.dataIndex)))})}}},t.prototype.createHTML=function(t,e){var n=this.createData(t,e);return{template:'<div class="stack component'+e.option("stackLevel",0)+'">'+n.map(function(t){return t.renderer.template}).join("")+"</div>",update:function(t,e,r){var i=0;a(t,n,"html"),n.forEach(function(n,o){var a=t.childNodes[o];a.style.transform="translate("+(n.shift-i)+"px,0)",n.renderer.update(a,e,r),n.stacked&&(i+=n.column.getWidth()*(1-n.column.getValue(e.v,e.dataIndex)))})}}},t.prototype.createCanvas=function(t,e){var n=this.createData(t,e);return function(t,e,r,i,o){var a=0;n.forEach(function(n){var s=n.shift-a;t.translate(s,0),n.renderer(t,e,r,i+s,o),t.translate(-s,0),n.stacked&&(a+=n.column.getWidth()*(1-n.column.getValue(e.v,e.dataIndex)))})}},t}(),D=new f,x=new g(!1,function(t,e,n){return n.getColor(t)}),C={rank:new f("rank","right"),boolean:new f("boolean","center"),number:new g,ordinal:new g(!0,function(t,e,n){return n.getColor(t)}),string:new T,selection:y,heatmap:E,link:_,annotate:m,actions:v,stack:new N,nested:new N(!1),categorical:new b,max:x,min:x,mean:x,script:x}},function(t,e,n){"use strict";var r=n(10),i=n(13),o=n(12),a=n(2),s=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},c=function(t){function e(e){void 0===e&&(e={});var i=t.call(this)||this;return i.rankings_=[],i.selection=new Set,i.uid=0,i.columnTypes=n.i(a.merge)({},n.i(r.models)()),i.multiSelections=!0,i.createHelper=function(t){var e=i.fromDescRef(t.desc),n=null;if(e&&e.type){i.fixDesc(t.desc);var r=i.columnTypes[e.type];n=new r(t.id,e),n.restore(t,i.createHelper)}return n},i.columnTypes=n.i(a.merge)(n.i(r.models)(),e.columnTypes||{}),i.multiSelections=e.multiSelection!==!1,i}return s(e,t),e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat([e.EVENT_ADD_COLUMN,e.EVENT_REMOVE_COLUMN,e.EVENT_ADD_RANKING,e.EVENT_REMOVE_RANKING,e.EVENT_DIRTY,e.EVENT_DIRTY_HEADER,e.EVENT_DIRTY_VALUES,e.EVENT_ORDER_CHANGED,e.EVENT_SELECTION_CHANGED,e.EVENT_ADD_DESC,e.EVENT_JUMP_TO_NEAREST])},e.prototype.pushRanking=function(t){var e=this.cloneRanking(t);return this.insertRanking(e),e},e.prototype.takeSnapshot=function(t){var e=this.cloneRanking();return e.push(this.clone(t)),this.insertRanking(e),e},e.prototype.insertRanking=function(t,r){void 0===r&&(r=this.rankings_.length),this.rankings_.splice(r,0,t),this.forward(t,i.a.EVENT_ADD_COLUMN+".provider",i.a.EVENT_REMOVE_COLUMN+".provider",i.a.EVENT_DIRTY+".provider",i.a.EVENT_DIRTY_HEADER+".provider",i.a.EVENT_ORDER_CHANGED+".provider",i.a.EVENT_DIRTY_VALUES+".provider");var o=this;t.on(i.a.EVENT_DIRTY_ORDER+".provider",n.i(a.delayedCall)(function(){o.triggerReorder(this.source)},100,null)),this.fire([e.EVENT_ADD_RANKING,e.EVENT_DIRTY_HEADER,e.EVENT_DIRTY_VALUES,e.EVENT_DIRTY],t,r),this.triggerReorder(t)},e.prototype.triggerReorder=function(t){this.sort(t).then(function(e){return t.setOrder(e)})},e.prototype.removeRanking=function(t){var n=this.rankings_.indexOf(t);return!(n<0)&&(this.unforward(t,i.a.EVENT_ADD_COLUMN+".provider",i.a.EVENT_REMOVE_COLUMN+".provider",i.a.EVENT_DIRTY+".provider",i.a.EVENT_DIRTY_HEADER+".provider",i.a.EVENT_ORDER_CHANGED+".provider",i.a.EVENT_DIRTY_VALUES+".provider"),this.rankings_.splice(n,1),t.on(i.a.EVENT_DIRTY_ORDER+".provider",null),this.cleanUpRanking(t),this.fire([e.EVENT_REMOVE_RANKING,e.EVENT_DIRTY_HEADER,e.EVENT_DIRTY_VALUES,e.EVENT_DIRTY],t,n),!0)},e.prototype.clearRankings=function(){var t=this;this.rankings_.forEach(function(e){t.unforward(e,i.a.EVENT_ADD_COLUMN+".provider",i.a.EVENT_REMOVE_COLUMN+".provider",i.a.EVENT_DIRTY+".provider",i.a.EVENT_DIRTY_HEADER+".provider",i.a.EVENT_ORDER_CHANGED+".provider",i.a.EVENT_DIRTY_VALUES+".provider"),e.on(i.a.EVENT_DIRTY_ORDER+".provider",null),t.cleanUpRanking(e)}),this.rankings_=[],this.fire([e.EVENT_REMOVE_RANKING,e.EVENT_DIRTY_HEADER,e.EVENT_DIRTY_VALUES,e.EVENT_DIRTY],null)},e.prototype.getRankings=function(){return this.rankings_.slice()},e.prototype.getLastRanking=function(){return this.rankings_[this.rankings_.length-1]},e.prototype.cleanUpRanking=function(t){},e.prototype.push=function(t,e){var n=this.create(e);return n?(t.push(n),n):null},e.prototype.insert=function(t,e,n){var r=this.create(n);return r?(t.insert(r,e),r):null},e.prototype.nextId=function(){return"col"+this.uid++},e.prototype.fixDesc=function(t){var e=this;"rank"===t.type?t.accessor=this.rankAccessor.bind(this):"selection"===t.type&&(t.accessor=function(t,n){return e.isSelected(n)},t.setter=function(t,n,r){return r?e.select(n):e.deselect(n)})},e.prototype.create=function(t){this.fixDesc(t);var e=this.columnTypes[t.type];return e?new e(this.nextId(),t):null},e.prototype.clone=function(t){var e=this.dumpColumn(t);return this.restoreColumn(e)},e.prototype.restoreColumn=function(t){var e=this,n=function(t){var r=e.fromDescRef(t.desc),i=e.columnTypes[r.type];e.fixDesc(r);var o=new i("",r);return o.restore(t,n),o.assignNewId(e.nextId.bind(e)),o};return n(t)},e.prototype.find=function(t){for(var e="string"==typeof t?function(e){return e.id===t}:t,n=0;n<this.rankings_.length;++n){var r=this.rankings_[n].find(e);if(r)return r}return null},e.prototype.dump=function(){var t=this;return{uid:this.uid,selection:this.getSelection(),rankings:this.rankings_.map(function(e){return e.dump(t.toDescRef)})}},e.prototype.dumpColumn=function(t){return t.dump(this.toDescRef)},e.prototype.toDescRef=function(t){return t},e.prototype.fromDescRef=function(t){return t},e.prototype.restoreRanking=function(t){var e=this.cloneRanking();e.restore(t,this.createHelper),e.children.some(function(t){return t instanceof o.a})||e.insert(this.create(n.i(r.createRankDesc)()),0);var i=this.nextId.bind(this);return e.children.forEach(function(t){return t.assignNewId(i)}),e},e.prototype.restore=function(t){var e=this;this.clearRankings(),this.uid=t.uid||0,t.selection&&t.selection.forEach(function(t){return e.selection.add(t)}),t.rankings&&t.rankings.forEach(function(t){var i=e.cloneRanking();i.restore(t,e.createHelper),i.children.some(function(t){return t instanceof o.a})||i.insert(e.create(n.i(r.createRankDesc)()),0),e.insertRanking(i)}),t.layout&&Object.keys(t.layout).forEach(function(n){e.deriveRanking(t.layout[n])});var i=this.nextId.bind(this);this.rankings_.forEach(function(t){t.children.forEach(function(t){return t.assignNewId(i)})})},e.prototype.deriveDefault=function(){var t=this;if(!(this.rankings_.length>0)){var e=this.pushRanking();this.getColumns().forEach(function(i){n.i(r.isSupportType)(i)||t.push(e,i)})}},e.prototype.deriveRanking=function(t){var e=this,i=this.cloneRanking();i.clear();var a=function(t){switch(t.type){case"rank":return e.create(n.i(r.createRankDesc)());case"selection":return e.create(n.i(r.createSelectionDesc)());case"actions":var i=e.create(n.i(r.createActionDesc)(t.label||"actions"));return i.restore(t,null),i;case"stacked":var o=e.create(n.i(r.createStackDesc)(t.label||"Combined"));return(t.children||[]).forEach(function(t){var e=a(t);e&&o.push(e)}),o;default:var s=e.findDesc(t.column);if(s){var i=e.create(s);return t.label=t.label||s.label||s.column,i.restore(t,null),i}return null}};return t.forEach(function(t){var e=a(t);e&&i.push(e)}),i.children.some(function(t){return t instanceof o.a})||i.insert(this.create(n.i(r.createRankDesc)()),0),this.insertRanking(i),i},e.prototype.isSelected=function(t){return this.selection.has(t)},e.prototype.select=function(t){this.selection.has(t)||(!this.multiSelections&&this.selection.size>0&&(this.selection=new Set),this.selection.add(t),this.fire(e.EVENT_SELECTION_CHANGED,this.getSelection()))},e.prototype.jumpToNearest=function(t){0!==t.length&&this.fire(e.EVENT_JUMP_TO_NEAREST,t)},e.prototype.selectAll=function(t){var n=this;t.every(function(t){return n.selection.has(t)})||(this.multiSelections||(this.selection=new Set,t=t.slice(0,1)),t.forEach(function(t){n.selection.add(t)}),this.fire(e.EVENT_SELECTION_CHANGED,this.getSelection()))},e.prototype.setSelection=function(t){var e=this;this.selection.size===t.length&&t.every(function(t){return e.selection.has(t)})||(this.selection=new Set,this.selectAll(t))},e.prototype.toggleSelection=function(t,e){return void 0===e&&(e=!1),this.isSelected(t)?(e?this.deselect(t):this.clearSelection(),!1):(e?this.select(t):this.setSelection([t]),!0)},e.prototype.deselect=function(t){this.selection.has(t)&&(this.selection.delete(t),this.fire(e.EVENT_SELECTION_CHANGED,this.getSelection()))},e.prototype.selectedRows=function(){return 0==this.selection.size?Promise.resolve([]):this.view(this.getSelection())},e.prototype.getSelection=function(){var t=[];return this.selection.forEach(function(e){return t.push(e)}),t.sort(),t},e.prototype.clearSelection=function(){0!==this.selection.size&&(this.selection=new Set,this.fire(e.EVENT_SELECTION_CHANGED,[],!1))},e.prototype.exportTable=function(t,e){function i(t,i){return!e.quote||i&&n.i(r.isNumberColumn)(i)?t:e.quoteChar+t+e.quoteChar}void 0===e&&(e={}),e=n.i(a.merge)({separator:"\t",newline:"\n",header:!0,quote:!1,quoteChar:'"',filter:function(t){return!n.i(r.isSupportType)(t)}},e);var o=t.flatColumns.filter(function(t){return e.filter(t.desc)}),s=t.getOrder();return this.view(s).then(function(t){var n=[];return e.header&&n.push(o.map(function(t){return i(t.label)}).join(e.separator)),t.forEach(function(t,r){n.push(o.map(function(e){return i(e.getLabel(t,s[r]),e)}).join(e.separator))}),n.join(e.newline)})},e}(a.AEventDispatcher);c.EVENT_SELECTION_CHANGED="selectionChanged",c.EVENT_ADD_COLUMN=i.a.EVENT_ADD_COLUMN,c.EVENT_REMOVE_COLUMN=i.a.EVENT_REMOVE_COLUMN,c.EVENT_ADD_RANKING="addRanking",c.EVENT_REMOVE_RANKING="removeRanking",c.EVENT_DIRTY=i.a.EVENT_DIRTY,c.EVENT_DIRTY_HEADER=i.a.EVENT_DIRTY_HEADER,c.EVENT_DIRTY_VALUES=i.a.EVENT_DIRTY_VALUES,c.EVENT_ORDER_CHANGED=i.a.EVENT_ORDER_CHANGED,c.EVENT_ADD_DESC="addDesc",c.EVENT_JUMP_TO_NEAREST="jumpToNearest",e.a=c},function(t,e,n){"use strict";function r(t){return"function"==typeof t.getCollapsed}var i=n(1);e.b=r;var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r._children=[],r}return o(e,t),e.prototype.assignNewId=function(e){t.prototype.assignNewId.call(this,e),this._children.forEach(function(t){return t.assignNewId(e)})},Object.defineProperty(e.prototype,"children",{get:function(){return this._children.slice()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._children.length},enumerable:!0,configurable:!0}),e.prototype.flatten=function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0);var o=0;return(0===n||n<=i.a.FLAT_ALL_COLUMNS)&&(o=this.getCompressed()?i.a.COMPRESSED_WIDTH:this.getWidth(),0===n)?o:(this._children.forEach(function(o){(!o.isHidden()||n<=i.a.FLAT_ALL_COLUMNS)&&o.flatten(t,e,n-1,r)}),o)},e.prototype.dump=function(e){var n=t.prototype.dump.call(this,e);return n.children=this._children.map(function(t){return t.dump(e)}),n},e.prototype.restore=function(e,n){var r=this;e.children.map(function(t){var e=n(t);e&&r.push(e)}),t.prototype.restore.call(this,e,n)},e.prototype.insert=function(t,e){return this._children.splice(e,0,t),this.insertImpl(t,e)},e.prototype.insertImpl=function(t,e){return t.parent=this,this.forward(t,i.a.EVENT_DIRTY_HEADER+".combine",i.a.EVENT_DIRTY_VALUES+".combine",i.a.EVENT_DIRTY+".combine",i.a.EVENT_FILTER_CHANGED+".combine"),this.fire([i.a.EVENT_ADD_COLUMN,i.a.EVENT_DIRTY_HEADER,i.a.EVENT_DIRTY_VALUES,i.a.EVENT_DIRTY],t,e),t},e.prototype.push=function(t){return this.insert(t,this._children.length)},e.prototype.at=function(t){return this._children[t]},e.prototype.indexOf=function(t){return this._children.indexOf(t)},e.prototype.insertAfter=function(t,e){var n=this.indexOf(e);return n<0?null:this.insert(t,n+1)},e.prototype.remove=function(t){var e=this._children.indexOf(t);return!(e<0)&&(this._children.splice(e,1),this.removeImpl(t))},e.prototype.removeImpl=function(t){return t.parent=null,this.unforward(t,i.a.EVENT_DIRTY_HEADER+".combine",i.a.EVENT_DIRTY_VALUES+".combine",i.a.EVENT_DIRTY+".combine",i.a.EVENT_FILTER_CHANGED+".combine"),this.fire([i.a.EVENT_REMOVE_COLUMN,i.a.EVENT_DIRTY_HEADER,i.a.EVENT_DIRTY_VALUES,i.a.EVENT_DIRTY],t),!0},e.prototype.getColor=function(t,e){return this.color},e.prototype.isFiltered=function(){return this._children.some(function(t){return t.isFiltered()})},e.prototype.filter=function(t,e){return this._children.every(function(n){return n.filter(t,e)})},e.prototype.toSortingDesc=function(t){return this._children.map(function(e){return e.toSortingDesc(t)})},e}(i.a);e.a=a},function(t,e,n){"use strict";var r=n(0),i=(n.n(r),n(8)),o=n(4),a=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},s=function(t){function e(e,i){var o=t.call(this,e,i)||this;return o.missingValue=0,o.numberFormat=n.i(r.format)(".3n"),i.numberFormat&&(o.numberFormat=n.i(r.format)(i.numberFormat)),o}return a(e,t),e.prototype.dump=function(e){var n=t.prototype.dump.call(this,e);return n.missingValue=this.missingValue,n},e.prototype.restore=function(e,i){e.missingValue&&(this.missingValue=e.missingValue),e.numberFormat&&(this.numberFormat=n.i(r.format)(e.numberFormat)),t.prototype.restore.call(this,e,i)},e.prototype.insert=function(e,r){return n.i(o.a)(e)?t.prototype.insert.call(this,e,r):null},e.prototype.getLabel=function(t,e){var n=this.getValue(t,e);return""+("number"==typeof n?this.numberFormat(n):n)},e.prototype.getValue=function(t,e){var n=this.compute(t,e);return"undefined"==typeof n||null==n||isNaN(n)?this.missingValue:n},e.prototype.compute=function(t,e){return NaN},e.prototype.getNumber=function(t,e){return this.getValue(t,e)},e.prototype.compare=function(t,e,r,i){return n.i(o.b)(this.getValue(t,r),this.getValue(e,i))},e.prototype.rendererType=function(){return o.c.prototype.rendererType.call(this)},e}(i.a);e.a=s},function(t,e,n){"use strict";function r(t,e){void 0===e&&(e={});var r=function(t){function e(e,n){var r=t.call(this,e,n)||this;return"function"==typeof r.init&&r.init.apply(r,[].slice.apply(arguments)),r}return V(e,t),e.prototype.init=function(){},e}(s.a);return r.prototype.toString=function(){return t},r.prototype=n.i(a.merge)(r.prototype,e),r}function i(t){return void 0===t&&(t="actions"),{type:"actions",label:t}}function o(){return{number:c.c,string:l.a,link:N.a,stack:u.a,rank:v.a,boolean:h.a,categorical:d.a,ordinal:_.a,actions:b.a,annotate:p.a,selection:y.a,max:g.a,min:f.a,mean:E.a,script:m.a,nested:T.a}}var a=n(2),s=n(3),c=n(4),l=n(5),u=n(15),p=n(32),h=n(33),d=n(11),f=n(22),g=n(20),E=n(21),v=n(12),y=n(17),m=n(14),_=n(34),T=n(23),b=n(35),N=n(19);Object.defineProperty(e,"__esModule",{value:!0});var D=n(1);n.d(e,"IColumnDesc",function(){return D.IColumnDesc}),n.d(e,"Column",function(){return D.a});var x=n(8);n.d(e,"CompositeColumn",function(){return x.a}),n.d(e,"createMappingFunction",function(){return c.f}),n.d(e,"ScriptMappingFunction",function(){return c.e}),n.d(e,"isNumberColumn",function(){return c.a}),n.d(e,"ScaleMappingFunction",function(){return c.d}),n.d(e,"isCategoricalColumn",function(){return d.b}),n.d(e,"Ranking",function(){return C.a}),n.d(e,"isSupportType",function(){return C.b});var C=n(13);n.d(e,"createMinDesc",function(){return f.b}),n.d(e,"createMaxDesc",function(){return g.b}),n.d(e,"createMeanDesc",function(){return E.b}),n.d(e,"createRankDesc",function(){return v.b}),n.d(e,"createSelectionDesc",function(){return y.b}),n.d(e,"createScriptDesc",function(){return m.b}),n.d(e,"createNestedDesc",function(){return T.b}),n.d(e,"createStackDesc",function(){return u.b}),e.defineColumn=r,e.createActionDesc=i,e.models=o;var V=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}},function(t,e,n){"use strict";function r(t){return t instanceof a.a&&"function"==typeof t.getCategories||!(t instanceof a.a)&&null!=t.type.match(/(categorical|ordinal)/)}function i(t,e){var n=null!=t?t.length:0,r=null!=e?e.length:0;return n===r&&(0===n||t.every(function(t,n){return t===e[n]}))}var o=n(0),a=(n.n(o),n(1)),s=n(3),c=n(5);e.b=r;var l=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},u=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.colors=o.scale.category10(),r.catLabels=new Map,r.currentFilter=null,r.separator=";",r.separator=n.separator||r.separator,r.initCategories(n),r}return l(e,t),e.prototype.initCategories=function(t){if(t.categories){var e=[],n=this.colors.range().slice(),r=new Map;t.categories.forEach(function(t,i){"string"==typeof t?e.push(t):(e.push(t.name||t.value),t.label&&r.set(t.name,t.label),t.color&&(n[i]=t.color))}),this.catLabels=r,this.colors.domain(e).range(n)}},Object.defineProperty(e.prototype,"categories",{get:function(){return this.colors.domain()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"categoryColors",{get:function(){return this.colors.range()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"categoryLabels",{get:function(){var t=this;return null===this.catLabels||0===this.catLabels.size?this.categories:this.categories.map(function(e){return t.catLabels.has(e)?t.catLabels.get(e):e})},enumerable:!0,configurable:!0}),e.prototype.colorOf=function(t){return this.colors(t)},e.prototype.getLabel=function(t,e){return null===this.catLabels||0===this.catLabels.size?""+c.a.prototype.getValue.call(this,t,e):this.getLabels(t,e).join(this.separator)},e.prototype.getFirstLabel=function(t,e){var n=this.getLabels(t,e);return n.length>0?n[0]:null},e.prototype.getLabels=function(t,e){var n=this,r=c.a.prototype.getValue.call(this,t,e),i=r?r.split(this.separator):[],o=function(t){return null===n.catLabels||0===n.catLabels.size?t:t.map(function(t){return n.catLabels.has(t)?n.catLabels.get(t):t})};return o(i)},e.prototype.getValue=function(t,e){var n=this.getValues(t,e);return n.length>0?n[0]:null},e.prototype.getValues=function(t,e){var n=c.a.prototype.getValue.call(this,t,e);return n?n.split(this.separator):[]},e.prototype.getCategories=function(t,e){return this.getValues(t,e)},e.prototype.getColor=function(t,e){var n=this.getValue(t,e);return null===n||""===n?null:this.colors(n)},e.prototype.getColors=function(t,e){return this.getCategories(t,e).map(this.colors)},e.prototype.dump=function(e){var n=t.prototype.dump.call(this,e);return n.filter=this.currentFilter,n.colors={domain:this.colors.domain(),range:this.colors.range(),separator:this.separator},null!==this.catLabels&&0!==this.catLabels.size&&(n.labels=this.catLabels.entries()),n},e.prototype.restore=function(e,n){var r=this;t.prototype.restore.call(this,e,n),this.currentFilter=e.filter||null,e.colors&&this.colors.domain(e.colors.domain).range(e.colors.range),e.labels&&(this.catLabels=new Map,e.labels.forEach(function(t){return r.catLabels.set(t.key,t.value)})),this.separator=e.separator||this.separator},e.prototype.isFiltered=function(){return null!=this.currentFilter},e.prototype.filter=function(t,e){if(!this.isFiltered())return!0;var n=this.getCategories(t,e),r=this.currentFilter;return n.every(function(t){return Array.isArray(r)&&r.length>0?r.indexOf(t)>=0:"string"==typeof r&&r.length>0?t&&t.toLowerCase().indexOf(r.toLowerCase())>=0:!(r instanceof RegExp)||null!=t&&t.match(r).length>0})},e.prototype.getFilter=function(){return this.currentFilter},e.prototype.setFilter=function(t){i(this.currentFilter,t)||this.fire([a.a.EVENT_FILTER_CHANGED,a.a.EVENT_DIRTY_VALUES,a.a.EVENT_DIRTY],this.currentFilter,this.currentFilter=t)},e.prototype.compare=function(t,e,r,i){for(var a=this.getValues(t,r),s=this.getValues(e,i),c=0;c<Math.min(a.length,s.length);++c){var l=n.i(o.ascending)(a[c],s[c]);if(0!==l)return l}return a.length-s.length},e}(s.a);e.a=u},function(t,e,n){"use strict";function r(t){return void 0===t&&(t="Rank"),{type:"rank",label:t}}var i=n(3);e.b=r;var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.setWidthImpl(50),r}return o(e,t),e}(i.a);e.a=a},function(t,e,n){"use strict";function r(t){return["rank","selection","actions"].indexOf(t.type)>=0}var i=n(1),o=n(5),a=n(2);e.b=r;var s=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},c=function(t){function e(r){var o=t.call(this)||this;return o.id=r,o.sortColumn=null,o.ascending=!1,o.columns=[],o.comparator=function(t,e,n,r){if(null===o.sortColumn)return 0;var i=o.sortColumn.compare(t,e,n,r);return o.ascending?i:-i},o.dirtyOrder=function(){o.fire([e.EVENT_DIRTY_ORDER,e.EVENT_DIRTY_VALUES,e.EVENT_DIRTY],o.getSortCriteria())},o.order=[],o.id=n.i(i.b)(r),o}return s(e,t),e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat([e.EVENT_WIDTH_CHANGED,e.EVENT_FILTER_CHANGED,e.EVENT_LABEL_CHANGED,e.EVENT_COMPRESS_CHANGED,e.EVENT_ADD_COLUMN,e.EVENT_REMOVE_COLUMN,e.EVENT_DIRTY,e.EVENT_DIRTY_HEADER,e.EVENT_DIRTY_VALUES,e.EVENT_SORT_CRITERIA_CHANGED,e.EVENT_DIRTY_ORDER,e.EVENT_ORDER_CHANGED])},e.prototype.assignNewId=function(t){this.id=n.i(i.b)(t()),this.columns.forEach(function(e){return e.assignNewId(t)})},e.prototype.setOrder=function(t){this.fire([e.EVENT_ORDER_CHANGED,e.EVENT_DIRTY_VALUES,e.EVENT_DIRTY],this.order,this.order=t)},e.prototype.getOrder=function(){return this.order},e.prototype.dump=function(t){var e={};return e.columns=this.columns.map(function(e){return e.dump(t)}),e.sortColumn={asc:this.ascending},this.sortColumn&&(e.sortColumn.sortBy=this.sortColumn.id),e},e.prototype.restore=function(t,e){var n=this;if(this.clear(),t.columns.map(function(t){var r=e(t);r&&n.push(r)}),t.sortColumn&&(this.ascending=t.sortColumn.asc,t.sortColumn.sortBy)){var r=this.columns.filter(function(e){return e.id===t.sortColumn.sortBy});this.sortBy(0===r.length?null:r[0],t.sortColumn.asc)}},e.prototype.flatten=function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0);var o=e;return(n>0||n<=i.a.FLAT_ALL_COLUMNS)&&this.columns.forEach(function(e){(!e.isHidden()||n<=i.a.FLAT_ALL_COLUMNS)&&(o+=e.flatten(t,o,n-1,r)+r)}),o-e},e.prototype.getSortCriteria=function(){return{col:this.sortColumn,asc:this.ascending}},e.prototype.toggleSorting=function(t){return this.sortColumn===t?this.sortBy(t,!this.ascending):this.sortBy(t)},e.prototype.setSortCriteria=function(t){return this.sortBy(t.col,t.asc)},e.prototype.sortBy=function(t,n){if(void 0===n&&(n=!1),null!==t&&t.findMyRanker()!==this)return!1;if(this.sortColumn===t&&this.ascending===n)return!0;this.sortColumn&&this.sortColumn.on(i.a.EVENT_DIRTY_VALUES+".order",null);var r=this.getSortCriteria();return this.sortColumn=t,this.sortColumn&&this.sortColumn.on(i.a.EVENT_DIRTY_VALUES+".order",this.dirtyOrder),this.ascending=n,this.fire([e.EVENT_SORT_CRITERIA_CHANGED,e.EVENT_DIRTY_ORDER,e.EVENT_DIRTY_HEADER,e.EVENT_DIRTY_VALUES,e.EVENT_DIRTY],r,this.getSortCriteria()),!0},Object.defineProperty(e.prototype,"children",{get:function(){return this.columns.slice()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this.columns.length},enumerable:!0,configurable:!0}),e.prototype.insert=function(t,n){return void 0===n&&(n=this.columns.length),this.columns.splice(n,0,t),t.parent=this,this.forward(t,i.a.EVENT_DIRTY_VALUES+".ranking",i.a.EVENT_DIRTY_HEADER+".ranking",i.a.EVENT_DIRTY+".ranking",i.a.EVENT_FILTER_CHANGED+".ranking"),t.on(e.EVENT_FILTER_CHANGED+".order",this.dirtyOrder),this.fire([e.EVENT_ADD_COLUMN,e.EVENT_DIRTY_HEADER,e.EVENT_DIRTY_VALUES,e.EVENT_DIRTY],t,n),null!==this.sortColumn||r(t.desc)||this.sortBy(t,t instanceof o.a),t},Object.defineProperty(e.prototype,"fqpath",{get:function(){return""},enumerable:!0,configurable:!0}),e.prototype.findByPath=function(t){for(var e=this,n=t.split("@").map(Number).slice(1);n.length>0;){var r=n.shift();e=e.at(r)}return e},e.prototype.indexOf=function(t){return this.columns.indexOf(t)},e.prototype.at=function(t){return this.columns[t]},e.prototype.insertAfter=function(t,e){var n=this.columns.indexOf(e);return n<0?null:this.insert(t,n+1)},e.prototype.push=function(t){return this.insert(t)},e.prototype.remove=function(t){var n=this.columns.indexOf(t);if(n<0)return!1;if(this.unforward(t,i.a.EVENT_DIRTY_VALUES+".ranking",i.a.EVENT_DIRTY_HEADER+".ranking",i.a.EVENT_DIRTY+".ranking",i.a.EVENT_FILTER_CHANGED+".ranking"),this.sortColumn===t){var o=this.columns.filter(function(e){return e!==t&&!r(e.desc)})[0];this.sortBy(o?o:null)}return t.parent=null,this.columns.splice(n,1),this.fire([e.EVENT_REMOVE_COLUMN,e.EVENT_DIRTY_HEADER,e.EVENT_DIRTY_VALUES,e.EVENT_DIRTY],t,n),!0},e.prototype.clear=function(){var t=this;0!==this.columns.length&&(this.sortColumn=null,this.columns.forEach(function(e){t.unforward(e,i.a.EVENT_DIRTY_VALUES+".ranking",i.a.EVENT_DIRTY_HEADER+".ranking",i.a.EVENT_DIRTY+".ranking",i.a.EVENT_FILTER_CHANGED+".ranking"),e.parent=null}),this.columns.length=0,this.fire([e.EVENT_REMOVE_COLUMN,e.EVENT_DIRTY_HEADER,e.EVENT_DIRTY_VALUES,e.EVENT_DIRTY],null))},Object.defineProperty(e.prototype,"flatColumns",{get:function(){var t=[];return this.flatten(t,0,i.a.FLAT_ALL_COLUMNS),t.map(function(t){return t.col})},enumerable:!0,configurable:!0}),e.prototype.find=function(t){for(var e="string"==typeof t?function(e){return e.id===t}:t,n=this.flatColumns,r=0;r<n.length;++r)if(e(n[r]))return n[r];return null},e.prototype.toSortingDesc=function(t){var e=function(e){return null===e?null:e.toSortingDesc(t)},n=e(this.sortColumn);return null===n?null:{id:n,asc:this.ascending}},e.prototype.isFiltered=function(){return this.columns.some(function(t){return t.isFiltered()})},e.prototype.filter=function(t,e){return this.columns.every(function(n){return n.filter(t,e)})},e.prototype.findMyRanker=function(){return this},Object.defineProperty(e.prototype,"fqid",{get:function(){return this.id},enumerable:!0,configurable:!0}),e}(a.AEventDispatcher);e.a=c,c.EVENT_WIDTH_CHANGED=i.a.EVENT_WIDTH_CHANGED,c.EVENT_FILTER_CHANGED=i.a.EVENT_FILTER_CHANGED,c.EVENT_LABEL_CHANGED=i.a.EVENT_LABEL_CHANGED,c.EVENT_COMPRESS_CHANGED=i.a.EVENT_COMPRESS_CHANGED,c.EVENT_ADD_COLUMN=i.a.EVENT_ADD_COLUMN,c.EVENT_REMOVE_COLUMN=i.a.EVENT_REMOVE_COLUMN,c.EVENT_DIRTY=i.a.EVENT_DIRTY,c.EVENT_DIRTY_HEADER=i.a.EVENT_DIRTY_HEADER,c.EVENT_DIRTY_VALUES=i.a.EVENT_DIRTY_VALUES,c.EVENT_SORT_CRITERIA_CHANGED="sortCriteriaChanged",c.EVENT_DIRTY_ORDER="dirtyOrder",c.EVENT_ORDER_CHANGED="orderChanged"},function(t,e,n){"use strict";function r(t){return void 0===t&&(t="script"),{type:"script",label:t,script:s.DEFAULT_SCRIPT}}var i=n(1),o=n(9);e.b=r;var a=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},s=function(t){function e(n,r){var i=t.call(this,n,r)||this;return i.script=e.DEFAULT_SCRIPT,i.f=null,i.script=r.script||i.script,i}return a(e,t),e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat([e.EVENT_SCRIPT_CHANGED])},e.prototype.setScript=function(t){this.script!==t&&(this.f=null,this.fire([e.EVENT_SCRIPT_CHANGED,i.a.EVENT_DIRTY_VALUES,i.a.EVENT_DIRTY],this.script,this.script=t))},e.prototype.getScript=function(){return this.script},e.prototype.dump=function(e){var n=t.prototype.dump.call(this,e);return n.script=this.script,n},e.prototype.restore=function(e,n){this.script=e.script||this.script,t.prototype.restore.call(this,e,n)},e.prototype.compute=function(t,e){return null==this.f&&(this.f=new Function("children","values",this.script)),this.f.call(this,this._children,this._children.map(function(n){return n.getValue(t,e)}))},e.prototype.toSortingDesc=function(t){return{code:this.script,operands:this._children.map(function(e){return e.toSortingDesc(t)})}},e}(o.a);e.a=s,s.EVENT_SCRIPT_CHANGED="scriptChanged",s.DEFAULT_SCRIPT="return Math.max.apply(Math,values)"},function(t,e,n){"use strict";function r(t){return void 0===t&&(t="Combined"),{type:"stack",label:t}}var i=n(9),o=n(1);e.b=r;var a=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},s=function(t){function e(e,n){var r=t.call(this,e,n)||this;r.collapsed=!1;var i=r;return r.adaptChange=function(t,e){i.adaptWidthChange(this.source,t,e)},r}return a(e,t),e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat([e.EVENT_COLLAPSE_CHANGED,e.EVENT_WEIGHTS_CHANGED]);
},e.prototype.setCollapsed=function(t){this.collapsed!==t&&this.fire([e.EVENT_COLLAPSE_CHANGED,o.a.EVENT_DIRTY_HEADER,o.a.EVENT_DIRTY_VALUES,o.a.EVENT_DIRTY],this.collapsed,this.collapsed=t)},e.prototype.getCollapsed=function(){return this.collapsed},e.prototype.flatten=function(t,e,n,r){void 0===n&&(n=0),void 0===r&&(r=0);var i=null,a=n<=o.a.FLAT_ALL_COLUMNS?this._children:this._children.filter(function(t){return!t.isHidden()});if(0===n||n<=o.a.FLAT_ALL_COLUMNS){var s=this.getCompressed()?o.a.COMPRESSED_WIDTH:this.getWidth();if(this.collapsed||this.getCompressed()||(s+=(a.length-1)*r),t.push(i={col:this,offset:e,width:s}),0===n)return s}var c=e;return a.forEach(function(e){c+=e.flatten(t,c,n-1,r)+r}),i&&(i.width=c-e-r),c-e-r},e.prototype.dump=function(e){var n=t.prototype.dump.call(this,e);return n.collapsed=this.collapsed,n},e.prototype.restore=function(e,n){this.collapsed=e.collapsed===!0,t.prototype.restore.call(this,e,n)},e.prototype.insert=function(e,n,r){return void 0===r&&(r=NaN),isNaN(r)||e.setWidth(r/(1-r)*this.getWidth()),e.on(o.a.EVENT_WIDTH_CHANGED+".stack",this.adaptChange),t.prototype.setWidth.call(this,0===this.length?e.getWidth():this.getWidth()+e.getWidth()),t.prototype.insert.call(this,e,n)},e.prototype.push=function(t,e){return void 0===e&&(e=NaN),this.insert(t,this.length,e)},e.prototype.insertAfter=function(t,e,n){void 0===n&&(n=NaN);var r=this.indexOf(e);return r<0?null:this.insert(t,r+1,n)},e.prototype.adaptWidthChange=function(t,n,r){if(n!==r){var i=this.getWeights(),a=this.getWidth(),s=(r-n)/a,c=n/a,l=(1-c-s)/(1-c);this._children.forEach(function(e){e===t||e.setWidthImpl(e.getWidth()*l)}),this.fire([e.EVENT_WEIGHTS_CHANGED,o.a.EVENT_DIRTY_HEADER,o.a.EVENT_DIRTY_VALUES,o.a.EVENT_DIRTY],i,this.getWeights())}},e.prototype.getWeights=function(){var t=this.getWidth();return this._children.map(function(e){return e.getWidth()/t})},e.prototype.setWeights=function(t){var n,r=this.getWeights(),i=t.length-this.length;if(i<0)if(n=t.reduce(function(t,e){return t+e},0),n<=1)for(var a=0;a<-i;++a)t.push((1-n)*(1/-i));else if(n<=100)for(var a=0;a<-i;++a)t.push((100-n)*(1/-i));t=t.slice(0,this.length),n=t.reduce(function(t,e){return t+e},0)/this.getWidth(),t=t.map(function(t){return t/n}),this._children.forEach(function(e,n){e.setWidthImpl(t[n])}),this.fire([e.EVENT_WEIGHTS_CHANGED,o.a.EVENT_DIRTY_HEADER,o.a.EVENT_DIRTY_VALUES,o.a.EVENT_DIRTY],r,t)},e.prototype.removeImpl=function(e){return e.on(o.a.EVENT_WIDTH_CHANGED+".stack",null),t.prototype.setWidth.call(this,1===this.length?100:this.getWidth()-e.getWidth()),t.prototype.removeImpl.call(this,e)},e.prototype.setWidth=function(e){var n=e/this.getWidth();this._children.forEach(function(t){t.setWidthImpl(t.getWidth()*n)}),t.prototype.setWidth.call(this,e)},e.prototype.compute=function(t,e){var n=this.getWidth();return this._children.reduce(function(r,i){return r+i.getValue(t,e)*(i.getWidth()/n)},0)},e.prototype.rendererType=function(){return this.getCollapsed()?e.COLLAPSED_RENDERER:t.prototype.rendererType.call(this)},e.prototype.toSortingDesc=function(t){var e=this.getWeights();return this._children.map(function(n,r){return{weight:e[r],id:n.toSortingDesc(t)}})},e}(i.a);e.a=s,s.EVENT_COLLAPSE_CHANGED="collapseChanged",s.EVENT_WEIGHTS_CHANGED="weightsChanged",s.COLLAPSED_RENDERER="number"},function(t,e,n){"use strict";var r,i=n(0),o=(n.n(i),n(2)),a=n(10),s=n(1),c=n(8),l=n(7),u=n(6),p=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)};!function(t){t[t.DIRTY=0]="DIRTY",t[t.SCROLLED=1]="SCROLLED"}(r||(r={}));var h=function(t){function e(e,r,a,s,c){void 0===c&&(c={});var l=t.call(this)||this;return l.data=e,l.slicer=a,l.options={rowHeight:20,rowPadding:1,rowBarPadding:1,idPrefix:"",slopeWidth:150,columnPadding:5,stacked:!0,animation:!1,animationDuration:1e3,renderers:n.i(o.merge)({},u.renderers),meanLine:!1,actions:[],freezeCols:0},l.histCache=new Map,n.i(o.merge)(l.options,c),l.$node=i.select(r).append(s).classed("lu-body",!0),l.changeDataStorage(e),l}return p(e,t),e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat([e.EVENT_HOVER_CHANGED,e.EVENT_RENDER_FINISHED])},Object.defineProperty(e.prototype,"node",{get:function(){return this.$node.node()},enumerable:!0,configurable:!0}),e.prototype.setOption=function(t,e){this.options[t]=e},e.prototype.changeDataStorage=function(t){this.data&&this.data.on([l.a.EVENT_DIRTY_VALUES+".bodyRenderer",l.a.EVENT_SELECTION_CHANGED+".bodyRenderer"],null),this.data=t,t.on(l.a.EVENT_DIRTY_VALUES+".bodyRenderer",n.i(o.delayedCall)(this.update.bind(this),1)),t.on(l.a.EVENT_SELECTION_CHANGED+".bodyRenderer",n.i(o.delayedCall)(this.drawSelection.bind(this),1))},e.prototype.showMeanLine=function(t){return this.options.meanLine&&n.i(a.isNumberColumn)(t)&&!t.getCompressed()&&t.parent instanceof a.Ranking},e.prototype.fireFinished=function(){this.fire(e.EVENT_RENDER_FINISHED,this)},e.prototype.createContext=function(t,e){function n(t,e){if(t in i)return i[t];if(t.indexOf(".")>0){var n=t.substring(0,t.indexOf("."));if(t=t.substring(t.indexOf(".")+1),n in i&&t in i[n])return i[n][t]}return e}var r=this,i=this.options;return{cellY:function(e){return(e+t)*r.options.rowHeight},cellPrevY:function(e){return(e+t)*r.options.rowHeight},idPrefix:i.idPrefix,option:n,rowHeight:function(){return i.rowHeight-i.rowPadding},renderer:function(t){return e(t,i.renderers,this)}}},e.prototype.select=function(t,e){return void 0===e&&(e=!1),this.data.toggleSelection(t,e)},e.prototype.fakeHover=function(t){this.mouseOver(t,!0)},e.prototype.mouseOver=function(t,n){void 0===n&&(n=!0),this.fire(e.EVENT_HOVER_CHANGED,n?t:-1)},e.prototype.scrolled=function(){return this.update(r.SCROLLED)},e.prototype.update=function(t){var e=this;void 0===t&&(t=r.DIRTY);var o=this.data.getRankings(),a=i.max(o,function(t){return t.getOrder().length})||0,l=this.options.rowHeight*a,u=this.slicer(0,a,function(t){return t*e.options.rowHeight}),p=function(t){return 0===u.from&&t.length<=u.to?t:t.slice(u.from,Math.min(t.length,u.to))},h=this.createContextImpl(u.from),d=o.map(function(t){return p(t.getOrder())}),f=this.data.fetch(d),g=this.options.columnPadding,E=0,v=o.map(function(t,r){var i=t.children.filter(function(t){return!t.isHidden()}),o=E,a=0,l=i.map(function(t){var e=a;return a+=(t.getCompressed()?s.a.COMPRESSED_WIDTH:t.getWidth())+g,!n.i(c.b)(t)||t.getCollapsed()||t.getCompressed()||(a+=g*(t.length-1)),{column:t,renderer:h.renderer(t),shift:e}});E+=a,E+=e.options.slopeWidth;var u=l.slice(0,e.options.freezeCols);return{id:t.id,ranking:t,order:d[r],shift:o,width:a,frozen:u,frozenWidth:Math.max.apply(Math,u.map(function(t){return t.shift+t.column.getWidth()})),columns:l.slice(e.options.freezeCols),data:f[r]}});E-=this.options.slopeWidth,this.updateImpl(v,h,E,l,t).then(this.fireFinished.bind(this))},e}(o.AEventDispatcher);h.EVENT_HOVER_CHANGED="hoverChanged",h.EVENT_RENDER_FINISHED="renderFinished",e.a=h},function(t,e,n){"use strict";function r(t){return void 0===t&&(t="S"),{type:"selection",label:t}}var i=n(0),o=(n.n(i),n(3));e.b=r;var a=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},s=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.setCompressed(!0),r}return a(e,t),e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat([e.EVENT_SELECT])},e.prototype.setValue=function(t,e,n){var r=this.getValue(t,e);return r===n||this.setImpl(t,e,n)},e.prototype.setImpl=function(t,n,r){return this.desc.setter&&this.desc.setter(t,n,r),this.fire(e.EVENT_SELECT,t,r),!0},e.prototype.toggleValue=function(t,e){var n=this.getValue(t,e);return this.setImpl(t,e,!n),!n},e.prototype.compare=function(t,e,r,o){return n.i(i.ascending)(this.getValue(t,r),this.getValue(e,o))},e}(o.a);e.a=s,s.EVENT_SELECT="select"},function(t,e,n){"use strict";function r(t){var e=l.scale.category10().range().slice();return t.forEach(function(t){switch(t.type){case"number":t.color=e.shift()}}),t}var i=n(7),o=n(6),a=n(26),s=n(16),c=n(2),l=n(0);n.n(l);e.a=r;var u=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},p=function(t){function e(r,s,u){void 0===u&&(u={});var p=t.call(this)||this;return p.data=s,p.config={idPrefix:Math.random().toString(36).slice(-8).substr(0,3),header:{headerHeight:20,headerHistogramHeight:40,autoRotateLabels:!1,rotationHeight:50,rotationDegree:-20,rankingButtons:a.dummyRankingButtonHook,linkTemplates:[]},htmlLayout:{},renderingOptions:{stacked:!0,animation:!0,histograms:!1,meanLine:!1},body:{renderer:"svg",rowHeight:18,rowPadding:1,rowBarPadding:1,visibleRowsOnly:!0,backupScrollRows:4,animationDuration:1e3,freezeCols:0,actions:[]},svgLayout:{},manipulative:!0,pool:!1,renderers:n.i(c.merge)({},o.renderers)},p.body=null,p.header=null,p.pools=[],p.contentScroller=null,p.isUpdateInitialized=!1,p.$container=r instanceof l.selection?r:n.i(l.select)(r),p.$container=p.$container.append("div").classed("lu",!0),p.config.svgLayout=p.config.body,p.config.htmlLayout=p.config.header,n.i(c.merge)(p.config,u),p.data.on(i.a.EVENT_SELECTION_CHANGED+".main",p.triggerSelection.bind(p)),p.data.on(i.a.EVENT_JUMP_TO_NEAREST+".main",p.jumpToNearest.bind(p)),p.header=new a.HeaderRenderer(s,p.node,n.i(c.merge)({},p.config.header,{idPrefix:p.config.idPrefix,manipulative:p.config.manipulative,histograms:p.config.renderingOptions.histograms,freezeCols:p.config.body.freezeCols})),p.body=n.i(a.createBodyRenderer)(p.config.body.renderer,s,p.node,p.slice.bind(p),n.i(c.merge)({},p.config.body,{meanLine:p.config.renderingOptions.meanLine,animation:p.config.renderingOptions.animation,stacked:p.config.renderingOptions.stacked,idPrefix:p.config.idPrefix,renderers:p.config.renderers})),p.body.histCache=p.header.sharedHistCache,p.forward(p.body,e.EVENT_HOVER_CHANGED),p.config.pool&&p.config.manipulative&&p.addPool(new a.PoolRenderer(s,p.node,p.config)),p.config.body.visibleRowsOnly&&(p.contentScroller=new c.ContentScroller(p.$container.node(),p.body.node,{backupRows:p.config.body.backupScrollRows,rowHeight:p.config.body.rowHeight,topShift:function(){return p.header.currentHeight()}}),p.contentScroller.on(c.ContentScroller.EVENT_SCROLL,function(t,e){p.header.$node.style("transform","translate(0px, "+t+"px)"),p.config.body.freezeCols>0&&(p.header.updateFreeze(e),p.body.updateFreeze(e))}),p.contentScroller.on(c.ContentScroller.EVENT_REDRAW,p.body.scrolled.bind(p.body))),p}return u(e,t),e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat([e.EVENT_HOVER_CHANGED,e.EVENT_SELECTION_CHANGED,e.EVENT_MULTISELECTION_CHANGED,e.EVENT_UPDATE_START,e.EVENT_UPDATE_FINISHED])},e.prototype.addPool=function(t,e){return void 0===e&&(e=this.config),t instanceof a.PoolRenderer?this.pools.push(t):this.pools.push(new a.PoolRenderer(this.data,t,e)),this.pools[this.pools.length-1]},Object.defineProperty(e.prototype,"node",{get:function(){return this.$container.node()},enumerable:!0,configurable:!0}),e.prototype.slice=function(t,e,n){return this.contentScroller?this.contentScroller.select(t,e,n):{from:t,to:e}},e.prototype.destroy=function(){this.pools.forEach(function(t){return t.remove()}),this.$container.remove(),this.contentScroller&&this.contentScroller.destroy()},e.prototype.sortBy=function(t,e){void 0===e&&(e=!1);var n=this.data.find(t);return n&&n.sortByMe(e),null!==n},e.prototype.dump=function(){return this.data.dump()},e.prototype.changeDataStorage=function(t,e){this.data&&this.data.on([i.a.EVENT_SELECTION_CHANGED+".main",i.a.EVENT_JUMP_TO_NEAREST+".main"],null),this.data=t,e&&this.data.restore(e),this.data.on(i.a.EVENT_SELECTION_CHANGED+".main",this.triggerSelection.bind(this)),this.data.on(i.a.EVENT_JUMP_TO_NEAREST+".main",this.jumpToNearest.bind(this)),this.header.changeDataStorage(t),this.body.changeDataStorage(t),this.pools.forEach(function(e){return e.changeDataStorage(t)}),this.update()},e.prototype.triggerSelection=function(t){this.fire(e.EVENT_SELECTION_CHANGED,t.length>0?t[0]:-1),this.fire(e.EVENT_MULTISELECTION_CHANGED,t)},e.prototype.jumpToNearest=function(t){var e=this,n=this.data.getRankings()[0];if(0!==t.length&&void 0!==n){var r=n.getOrder(),i=t.map(function(t){return r.indexOf(t)}).sort(function(t,e){return t-e});if(this.contentScroller)this.contentScroller.scrollIntoView(0,r.length,i[0],function(t){return t*e.config.body.rowHeight});else{var o=this.$container.node();o.scrollTop=i[0]*this.config.body.rowHeight}setTimeout(function(){e.body.fakeHover(r[i[0]])},100)}},e.prototype.restore=function(t){this.changeDataStorage(this.data,t)},e.prototype.update=function(){var t=this,n=this.isUpdateInitialized?1:3;this.isUpdateInitialized=!0,this.fire(e.EVENT_UPDATE_START),this.header.update(),this.body.update(),this.pools.forEach(function(t){return t.update()}),this.body.on(s.a.EVENT_RENDER_FINISHED+".main",function(){n-=1,0===n&&t.fire(e.EVENT_UPDATE_FINISHED)})},e.prototype.changeRenderingOption=function(t,e){this.config.renderingOptions[t]=e,"animation"!==t&&"stacked"!==t||(this.body.setOption(t,e),this.body.update())},e}(c.AEventDispatcher);e.b=p,p.EVENT_HOVER_CHANGED=s.a.EVENT_HOVER_CHANGED,p.EVENT_SELECTION_CHANGED=i.a.EVENT_SELECTION_CHANGED,p.EVENT_MULTISELECTION_CHANGED="multiSelectionChanged",p.EVENT_UPDATE_START="updateStart",p.EVENT_UPDATE_FINISHED="updateFinished"},function(t,e,n){"use strict";var r=n(1),i=n(5),o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.link=null,r.link=n.link,r}return o(e,t),Object.defineProperty(e.prototype,"headerCssClass",{get:function(){return null==this.link?"link":"link link_pattern"},enumerable:!0,configurable:!0}),e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat([e.EVENT_LINK_CHANGED])},e.prototype.setLink=function(t){t!=this.link&&this.fire([e.EVENT_LINK_CHANGED,r.a.EVENT_DIRTY_HEADER,r.a.EVENT_DIRTY_VALUES,r.a.EVENT_DIRTY],this.link,this.link=t)},e.prototype.getLink=function(){return this.link||""},e.prototype.dump=function(e){var n=t.prototype.dump.call(this,e);return this.link!=this.desc.link&&(n.link=this.link),n},e.prototype.restore=function(e,n){t.prototype.restore.call(this,e,n),e.link&&(this.link=e.link)},e.prototype.getLabel=function(e,n){var r=t.prototype.getRaw.call(this,e,n);return r&&r.alt?r.alt:""+r},e.prototype.isLink=function(e,n){if(this.link)return!0;var r=t.prototype.getRaw.call(this,e,n);return r&&null!=r.href},e.prototype.getValue=function(e,n){var r=t.prototype.getRaw.call(this,e,n);return r&&r.href?r.href:this.link?this.link.replace(/\$1/g,r||""):r},e}(i.a);e.a=a,a.EVENT_LINK_CHANGED="linkChanged"},function(t,e,n){"use strict";function r(t){return void 0===t&&(t="Max"),{type:"max",label:t}}var i=n(0),o=(n.n(i),n(9));e.b=r;var a=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},s=function(t){function e(){return t.apply(this,arguments)||this}return a(e,t),e.prototype.getColor=function(t,e){var n=this._children;if(0===n.length)return this.color;for(var r=0,i=n[0].getValue(t,e),o=1;o<n.length;++o){var a=n[o].getValue(t,e);a>i&&(r=o,i=a)}return n[r].color},e.prototype.compute=function(t,e){return n.i(i.max)(this._children,function(n){return n.getValue(t,e)})},e.prototype.toSortingDesc=function(t){return{operation:"max",operands:this._children.map(function(e){return e.toSortingDesc(t)})}},e}(o.a);e.a=s},function(t,e,n){"use strict";function r(t){return void 0===t&&(t="Mean"),{type:"mean",label:t}}var i=n(0),o=(n.n(i),n(9));e.b=r;var a=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},s=function(t){function e(){return t.apply(this,arguments)||this}return a(e,t),e.prototype.compute=function(t,e){return n.i(i.mean)(this._children,function(n){return n.getValue(t,e)})},e.prototype.toSortingDesc=function(t){return{operation:"avg",operands:this._children.map(function(e){return e.toSortingDesc(t)})}},e}(o.a);e.a=s},function(t,e,n){"use strict";function r(t){return void 0===t&&(t="Min"),{type:"min",label:t}}var i=n(0),o=(n.n(i),n(9));e.b=r;var a=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},s=function(t){function e(){return t.apply(this,arguments)||this}return a(e,t),e.prototype.getColor=function(t,e){var n=this._children;if(0===n.length)return this.color;for(var r=0,i=n[0].getValue(t,e),o=1;o<n.length;++o){var a=n[o].getValue(t,e);a<i&&(r=o,i=a)}return n[r].color},e.prototype.compute=function(t,e){return n.i(i.min)(this._children,function(n){return n.getValue(t,e)})},e.prototype.toSortingDesc=function(t){return{operation:"min",operands:this._children.map(function(e){return e.toSortingDesc(t)})}},e}(o.a);e.a=s},function(t,e,n){"use strict";function r(t){return void 0===t&&(t="Nested"),{type:"nested",label:t}}var i=n(36);e.b=r;var o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a=function(t){function e(){return t.apply(this,arguments)||this}return o(e,t),e.prototype.compare=function(t,e,n,r){for(var i=this.children,o=0,a=i;o<a.length;o++){var s=a[o],c=s.compare(t,e,n,r);if(0!==c)return c}return 0},e.prototype.getLabel=function(t,e){return this.children.map(function(n){return n.getLabel(t,e)}).join(";")},e.prototype.getValue=function(t,e){return this.children.map(function(n){return n.getValue(t,e)}).join(";")},e}(i.a);e.a=a},function(t,e,n){"use strict";var r=n(0),i=(n.n(r),n(2)),o=n(6),a=n(16),s=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},c=function(t){function e(e,n,r,i,o){void 0===o&&(o={});var a=t.call(this,e,n,r,i.root,o)||this;return a.domMapping=i,a.currentFreezeLeft=0,a}return s(e,t),e.prototype.animated=function(t){return this.options.animationDuration>0&&this.options.animation?t.transition().duration(this.options.animationDuration):t},e.prototype.renderRankings=function(t,e,i,a){var s=this,c=this,l=this.domMapping,u=this.domMapping.g,p=t.selectAll(u+".ranking").data(e,function(t){return t.id}),h=p.enter().append(u).attr("class","ranking").call(l.transform,function(t){return[t.shift,0]});h.append(u).attr("class","rows"),h.append(u).attr("class","meanlines").attr("clip-path","url(#c"+this.options.idPrefix+"Freeze)"),this.animated(p).call(l.transform,function(t,e){return[t.shift,0]});var d=[],f=p.select(u+".rows").selectAll(u+".row").data(function(t){return t.order},String),g=f.enter().append(u).attr("class","row");g.call(l.transform,function(t,e){return[0,i.cellPrevY(e)]}),g.append(l.bg).attr("class","bg"),g.on("mouseenter",function(t){return s.mouseOver(t,!0)}).on("mouseleave",function(t){return s.mouseOver(t,!1)}).on("click",function(t){return s.select(t,r.event.ctrlKey)});var E=function(t,e){n.i(o.matchColumns)(t,e),e.forEach(function(e,n){var r=t.childNodes[n];l.translate(r,e.shift,0)})};g.append(u).attr("class","cols").attr("clip-path","url(#c"+this.options.idPrefix+"Freeze)").each(function(t,n,r){E(this,e[r].columns)}),g.append(u).attr("class","frozen").call(this.domMapping.transform,function(){return[s.currentFreezeLeft,0]}).each(function(t,n,r){E(this,e[r].frozen)}),f.attr("class",function(t,e){return"row "+(e%2===0?"even":"")}).attr("data-data-index",function(t){return t}).classed("selected",function(t){return s.data.isSelected(t)}),this.animated(f).call(l.transform,function(t,e){return[0,i.cellY(e)]}),f.select(l.bg).attr("class","bg").call(l.updateBG,function(t,n,r){return[e[r].width,i.rowHeight(n)]});var v=function(t,e,r,i){return e.data[r].then(function(e){n.i(o.matchColumns)(t,i),i.forEach(function(n,i){var o=t.childNodes[i];l.translate(o,n.shift,0),n.renderer.update(o,e,r)})})};f.select(u+".cols").each(function(t,n,r){d.push(v(this,e[r],n,e[r].columns))});var y=0===e.length||0===e[0].frozen.length?0:r.max(e[0].frozen,function(t){return t.shift+t.column.getWidth()});f.select(u+".frozen").each(function(t,n,r){l.setSize(this,y,c.options.rowHeight),d.push(v(this,e[r],n,e[r].frozen))}),f.exit().remove();var m=p.select(u+".meanlines").selectAll(l.meanLine+".meanline").data(function(t){return t.columns.filter(function(t){return s.showMeanLine(t.column)})});return m.enter().append(l.meanLine).attr("class","meanline"),m.each(function(t){var e=c.histCache.get(t.column.id),n=r.select(this);e&&e.then(function(e){var r=t.shift+t.column.getWidth()*e.mean;l.updateMeanLine(n,isNaN(r)?0:r,a)})}),m.exit().remove(),p.exit().remove(),Promise.all(d)},e.prototype.select=function(e,n){void 0===n&&(n=!1);var r=t.prototype.select.call(this,e,n);return this.$node.selectAll('[data-data-index="'+e+'"').classed("selected",r),r},e.prototype.drawSelection=function(){var t=this.data.getSelection();if(n.i(i.forEach)(this.node,".selected",function(t){return t.classList.remove("selected")}),0!==t.length){var e=t.map(function(t){return'[data-data-index="'+t+'"]'}).join(",");n.i(i.forEach)(this.node,e,function(t){return t.classList.add("selected")})}},e.prototype.mouseOver=function(e,r){function o(t){t.classList.add("hover")}void 0===r&&(r=!0),t.prototype.mouseOver.call(this,e,r),n.i(i.forEach)(this.node,".hover",function(t){return t.classList.remove("hover")}),r&&n.i(i.forEach)(this.node,'[data-data-index="'+e+'"]',o)},e.prototype.renderSlopeGraphs=function(t,e,n,r){var i=this,o=e.slice(1).map(function(t,n){return{left:e[n].order,left_i:n,right:t.order,right_i:n+1}}),a=t.selectAll(this.domMapping.slopes+".slopegraph").data(o);a.enter().append(this.domMapping.slopes).attr("class","slopegraph"),a.call(this.domMapping.updateSlopes,this.options.slopeWidth,r,function(t,n){return e[n+1].shift-i.options.slopeWidth});var s=a.selectAll("line.slope").data(function(t){var e=new Map;return t.right.forEach(function(t,n){return e.set(t,n)}),t.left.map(function(t,n){return{data_index:t,lpos:n,rpos:e.get(t)}}).filter(function(t){return null!=t.rpos})});s.enter().append("line").attr({class:"slope",x2:this.options.slopeWidth}).on("mouseenter",function(t){return i.mouseOver(t.data_index,!0)}).on("mouseleave",function(t){return i.mouseOver(t.data_index,!1)}),s.attr("data-data-index",function(t){return t.data_index}),s.attr({y1:function(t){return.5*n.rowHeight(t.lpos)+n.cellY(t.lpos)},y2:function(t){return.5*n.rowHeight(t.rpos)+n.cellY(t.rpos)}}),s.exit().remove(),a.exit().remove()},e.prototype.updateFreeze=function(t){var e=this;n.i(i.forEach)(this.node,this.domMapping.g+".row .frozen",function(n){e.domMapping.translate(n,t,0)});var r=this.node.querySelector("clipPath#c"+this.options.idPrefix+"Freeze");r&&this.domMapping.translate(r,t,0),this.currentFreezeLeft=t},e.prototype.createContextImpl=function(t){return this.createContext(t,this.domMapping.creator)},e.prototype.updateImpl=function(t,e,n,r,i){this.domMapping.setSize(this.node,Math.max(0,n),r);var o=this.$node.select(this.domMapping.g+".body");return o.empty()&&(o=this.$node.append(this.domMapping.g).classed("body",!0)),this.renderSlopeGraphs(o,t,e,r),this.updateClipPaths(t,e,r),this.renderRankings(o,t,e,r)},e}(a.a);e.a=c},function(t,e,n){"use strict";function r(t){var e=t.label;return null!=t.description&&""!==t.description&&(e+="\n"+t.description),e}function i(){return null}function o(t){return!n.i(p.b)(t)||t.getCollapsed()||t.getCompressed()?1:1+Math.max.apply(Math,t.children.map(o))}var a=n(0),s=(n.n(a),n(2)),c=n(1),l=n(5),u=n(13),p=n(8),h=n(4),d=n(11),f=n(12),g=n(15),E=n(19),v=n(14),y=n(7),m=n(27);e.a=r,e.b=i;var _=function(){function t(t,e,r){var o=this;this.data=t,this.options={idPrefix:"",slopeWidth:150,columnPadding:5,headerHistogramHeight:40,headerHeight:20,manipulative:!0,histograms:!1,filterDialogs:n.i(m.filterDialogs)(),linkTemplates:[],searchAble:function(t){return t instanceof l.a},sortOnLabel:!0,autoRotateLabels:!1,rotationHeight:50,rotationDegree:-20,freezeCols:0,rankingButtons:i},this.histCache=new Map,this.dragHandler=a.behavior.drag().on("dragstart",function(){a.select(this).classed("dragging",!0),a.event.sourceEvent.stopPropagation(),a.event.sourceEvent.preventDefault()}).on("drag",function(t){var e=Math.max(a.mouse(this.parentNode)[0],2);t.setWidth(e),a.event.sourceEvent.stopPropagation(),a.event.sourceEvent.preventDefault()}).on("dragend",function(){a.select(this).classed("dragging",!1),a.event.sourceEvent.stopPropagation(),a.event.sourceEvent.preventDefault()}),this.dropHandler=n.i(s.dropAble)(["application/caleydo-lineup-column-ref","application/caleydo-lineup-column"],function(t,e,n){var r=null;if("application/caleydo-lineup-column-ref"in t){var i=t["application/caleydo-lineup-column-ref"];r=o.data.find(i),n?r=o.data.clone(r):r.removeMe()}else{var a=JSON.parse(t["application/caleydo-lineup-column"]);r=o.data.create(o.data.fromDescRef(a))}if(e instanceof c.a)return null!=e.insertAfterMe(r);var s=o.data.getLastRanking();return null!==s.push(r)}),n.i(s.merge)(this.options,r),this.$node=a.select(e).append("div").classed("lu-header",!0),this.$node.append("div").classed("drop",!0).call(this.dropHandler),this.changeDataStorage(t)}return t.prototype.changeDataStorage=function(t){var e=this;this.data&&this.data.on([y.a.EVENT_DIRTY_HEADER+".headerRenderer",y.a.EVENT_ORDER_CHANGED+".headerRenderer",y.a.EVENT_SELECTION_CHANGED+".headerRenderer"],null),this.data=t,t.on(y.a.EVENT_DIRTY_HEADER+".headerRenderer",n.i(s.delayedCall)(this.update.bind(this),1)),this.options.histograms&&(t.on(y.a.EVENT_ORDER_CHANGED+".headerRenderer",function(){e.updateHist(),e.update()}),t.on(y.a.EVENT_SELECTION_CHANGED+".headerRenderer",n.i(s.delayedCall)(this.drawSelection.bind(this),1)))},Object.defineProperty(t.prototype,"sharedHistCache",{get:function(){return this.histCache},enumerable:!0,configurable:!0}),t.prototype.currentHeight=function(){return parseInt(this.$node.style("height"),10)},t.prototype.updateHist=function(){var t=this,e=this.data.getRankings();e.forEach(function(e){var r=e.getOrder(),i=e.flatColumns,o=null==r?null:t.data.stats(r);i.filter(function(t){return t instanceof h.c&&!t.isHidden()}).forEach(function(e){t.histCache.set(e.id,null===o?null:o.stats(e))}),i.filter(function(t){return n.i(d.b)(t)&&!t.isHidden()}).forEach(function(e){t.histCache.set(e.id,null===o?null:o.hist(e))})})},t.prototype.drawSelection=function(){var t=this;if(this.options.histograms){var e=this.$node.node();n.i(s.forEach)(e,"div.bar",function(t){return t.classList.remove("selected")});var r=this.data.getSelection();r.length<=0||this.data.view(r).then(function(i){var o=t.data.getRankings();o.forEach(function(t){var o=t.flatColumns;o.filter(function(t){return t instanceof h.c&&!t.isHidden()}).forEach(function(t){var n=[].slice.call(e.querySelectorAll('div.header[data-id="'+t.id+'"] div.bar'));i.forEach(function(e,i){for(var o=t.getValue(e,r[i]),a=1;a<n.length;++a){var s=n[a];if(s.dataset.x>o){n[a-1].classList.add("selected");break}if(a===n.length-1){s.classList.add("selected");break}}})}),o.filter(function(t){return n.i(d.b)(t)&&!t.isHidden()}).forEach(function(t){var n=e.querySelector('div.header[data-id="'+t.id+'"]');i.forEach(function(e,i){var o=t.getCategories(e,r[i]);(o||[]).forEach(function(t){n.querySelector('div.bar[data-cat="'+t+'"]').classList.add("selected")})})})})})}},t.prototype.renderRankingButtons=function(t,e){var n=this.$node.selectAll("div.rankingbuttons").data(t);n.enter().append("div").classed("rankingbuttons",!0).call(this.options.rankingButtons),n.style("left",function(t,n){return e[n]+"px"}),n.exit().remove()},t.prototype.update=function(){var t=this,e=this,n=this.data.getRankings(),r=[],s=0,c=[];n.forEach(function(e){s+=e.flatten(r,s,1,t.options.columnPadding)+t.options.slopeWidth,c.push(s-t.options.slopeWidth)}),s-=this.options.slopeWidth,this.$node.select("div.drop").style("width",s+"px");var l=r.map(function(t){return t.col});this.options.histograms&&0===this.histCache.size&&n.length>0&&this.updateHist(),this.renderColumns(l,r),this.options.rankingButtons!==i&&this.renderRankingButtons(n,c);var u=Math.max.apply(Math,l.map(o)),p=(this.options.histograms?this.options.headerHistogramHeight:this.options.headerHeight)+(u-1)*this.options.headerHeight;if(this.options.autoRotateLabels){var h=!1;this.$node.selectAll("div.header").style("height",p+"px").select("div.lu-label").each(function(t){var n=this.querySelector("span.lu-label").offsetWidth,r=t.getWidth();n>r+30?(a.select(this).style("transform","rotate("+e.options.rotationDegree+"deg)"),h=!0):a.select(this).style("transform",null)}),this.$node.selectAll("div.header").style("margin-top",h?this.options.rotationHeight+"px":null),p+=h?this.options.rotationHeight:0}this.$node.style("height",p+"px")},t.prototype.createToolbar=function(t){var e=this,r=this.options.filterDialogs,i=this.data,o=this,s=t.filter(function(t){return!(t instanceof f.a)});s.append("i").attr("class","fa fa-pencil-square-o").attr("title","Rename").on("click",function(t){n.i(m.openRenameDialog)(t,a.select(this.parentNode.parentNode)),a.event.stopPropagation()}),s.append("i").attr("class","fa fa-code-fork").attr("title","Generate Snapshot").on("click",function(t){i.takeSnapshot(t),a.event.stopPropagation()}),t.filter(function(t){return t instanceof E.a}).append("i").attr("class","fa fa-external-link").attr("title","Edit Link Pattern").on("click",function(t){n.i(m.openEditLinkDialog)(t,a.select(this.parentNode.parentNode),[].concat(t.desc.templates||[],o.options.linkTemplates),o.options.idPrefix),a.event.stopPropagation()}),t.filter(function(t){return t instanceof v.a}).append("i").attr("class","fa fa-gears").attr("title","Edit Combine Script").on("click",function(t){n.i(m.openEditScriptDialog)(t,a.select(this.parentNode.parentNode)),a.event.stopPropagation()}),t.filter(function(t){return r.hasOwnProperty(t.desc.type)}).append("i").attr("class","fa fa-filter").attr("title","Filter").on("click",function(t){r[t.desc.type](t,a.select(this.parentNode.parentNode),i,o.options.idPrefix),a.event.stopPropagation()}),t.filter(function(t){return e.options.searchAble(t)}).append("i").attr("class","fa fa-search").attr("title","Search").on("click",function(t){n.i(m.openSearchDialog)(t,a.select(this.parentNode.parentNode),i),a.event.stopPropagation()}),t.filter(function(t){return t instanceof g.a}).append("i").attr("class","fa fa-tasks").attr("title","Edit Weights").on("click",function(t){n.i(m.openEditWeightsDialog)(t,a.select(this.parentNode.parentNode)),a.event.stopPropagation()}),s.append("i").attr("class","fa").classed("fa-toggle-left",function(t){return!t.getCompressed()}).classed("fa-toggle-right",function(t){return t.getCompressed()}).attr("title","(Un)Collapse").on("click",function(t){t.setCompressed(!t.getCompressed()),a.select(this).classed("fa-toggle-left",!t.getCompressed()).classed("fa-toggle-right",t.getCompressed()),a.event.stopPropagation()}),t.filter(function(t){return n.i(p.b)(t)}).append("i").attr("class","fa").classed("fa-compress",function(t){return!t.getCollapsed()}).classed("fa-expand",function(t){return t.getCollapsed()}).attr("title","Compress/Expand").on("click",function(t){t.setCollapsed(!t.getCollapsed()),a.select(this).classed("fa-compress",!t.getCollapsed()).classed("fa-expand",t.getCollapsed()),a.event.stopPropagation()}),t.append("i").attr("class","fa fa-times").attr("title","Hide").on("click",function(t){
t instanceof f.a?(i.removeRanking(t.findMyRanker()),0===i.getRankings().length&&i.pushRanking()):t.removeMe(),a.event.stopPropagation()})},t.prototype.updateFreeze=function(t){var e=this.options.freezeCols;this.$node.selectAll("div.header").style("z-index",function(t,n){return n<e?1:null}).style("transform",function(n,r){return r<e?"translate("+t+"px,0)":null})},t.prototype.renderColumns=function(t,e,i,o){var c=this;void 0===i&&(i=this.$node),void 0===o&&(o="header");var l=this,f=i.selectAll("div."+o).data(t,function(t){return t.id}),E=f.enter().append("div").attr("class",o).on("click",function(t){var e=a.event;c.options.manipulative&&!e.defaultPrevented&&e.currentTarget===e.target&&t.toggleMySorting()}),v=E.append("div").classed("lu-label",!0).on("click",function(t){var e=a.event;c.options.manipulative&&!e.defaultPrevented&&t.toggleMySorting()}).on("dragstart",function(t){var e=a.event;e.dataTransfer.effectAllowed="copyMove",e.dataTransfer.setData("text/plain",t.label),e.dataTransfer.setData("application/caleydo-lineup-column-ref",t.id);var r=JSON.stringify(c.data.toDescRef(t.desc));e.dataTransfer.setData("application/caleydo-lineup-column",r),n.i(h.a)(t)&&(e.dataTransfer.setData("application/caleydo-lineup-column-number",r),e.dataTransfer.setData("application/caleydo-lineup-column-number-ref",t.id))});v.append("i").attr("class","fa fa sort_indicator"),v.append("span").classed("lu-label",!0).attr({draggable:this.options.manipulative}),this.options.manipulative&&(E.append("div").classed("handle",!0).call(this.dragHandler).style("width",this.options.columnPadding+"px").call(this.dropHandler),E.append("div").classed("toolbar",!0).call(this.createToolbar.bind(this))),this.options.histograms&&E.append("div").classed("histogram",!0),f.style({width:function(t,n){return e[n].width+c.options.columnPadding+"px"},left:function(t,n){return e[n].offset+"px"},"background-color":function(t){return t.color}}),f.attr({class:function(t){return o+" "+(t.cssClass||"")+" "+(t.getCompressed()?"compressed":"")+" "+t.headerCssClass+" "+(c.options.autoRotateLabels?"rotateable":"")+" "+(t.isFiltered()?"filtered":"")},title:function(t){return r(t)},"data-id":function(t){return t.id}}),f.select("i.sort_indicator").attr("class",function(t){var e=t.findMyRanker();return e&&e.getSortCriteria().col===t?"sort_indicator fa fa-sort-"+(e.getSortCriteria().asc?"asc":"desc"):"sort_indicator fa"}),f.select("span.lu-label").text(function(t){return t.label}),f.filter(function(t){return n.i(p.b)(t)}).each(function(t){if(t.getCollapsed()||t.getCompressed())a.select(this).selectAll("div."+o+"_i").remove();else{var e=[];t.flatten(e,0,1,l.options.columnPadding);var n=e.map(function(t){return t.col});l.renderColumns(n,e,a.select(this),o+("_i"!==o.substr(o.length-2)?"_i":""))}}).select("div.lu-label").call(n.i(s.dropAble)(["application/caleydo-lineup-column-number-ref","application/caleydo-lineup-column-number"],function(t,e,n){var r=null;if("application/caleydo-lineup-column-number-ref"in t){var i=t["application/caleydo-lineup-column-number-ref"];r=c.data.find(i),n?r=c.data.clone(r):r&&r.removeMe()}else{var o=JSON.parse(t["application/caleydo-lineup-column-number"]);r=c.data.create(c.data.fromDescRef(o))}return null!=e.push(r)})),f.filter(function(t){return t.parent instanceof u.a&&n.i(h.a)(t)&&!n.i(p.b)(t)}).select("div.lu-label").call(n.i(s.dropAble)(["application/caleydo-lineup-column-number-ref","application/caleydo-lineup-column-number"],function(t,e,r){var i=null;if("application/caleydo-lineup-column-number-ref"in t){var o=t["application/caleydo-lineup-column-number-ref"];i=c.data.find(o),r?i=c.data.clone(i):i&&i.removeMe()}else{var a=JSON.parse(t["application/caleydo-lineup-column-number"]);i=c.data.create(c.data.fromDescRef(a))}var s=e.findMyRanker(),l=s.indexOf(e),u=c.data.create(n.i(g.b)());return e.removeMe(),u.push(e),u.push(i),null!=s.insert(u,l)})),this.options.histograms&&(f.filter(function(t){return n.i(d.b)(t)}).each(function(t){var e=a.select(this).select("div.histogram"),n=l.histCache.get(t.id);n&&n.then(function(n){var r=e.selectAll("div.bar").data(n.hist);r.enter().append("div").classed("bar",!0);var i=a.scale.ordinal().domain(t.categories).rangeBands([0,100],.1),o=a.scale.linear().domain([0,n.maxBin]).range([0,100]);r.style({left:function(t){return i(t.cat)+"%"},width:function(t){return i.rangeBand()+"%"},top:function(t){return 100-o(t.y)+"%"},height:function(t){return o(t.y)+"%"},"background-color":function(e){return t.colorOf(e.cat)}}).attr({title:function(t){return t.cat+": "+t.y},"data-cat":function(t){return t.cat}}),r.exit().remove()})}),f.filter(function(t){return t instanceof h.c}).each(function(t){var e=a.select(this).select("div.histogram"),n=l.histCache.get(t.id);n&&n.then(function(t){var n=e.selectAll("div.bar").data(t.hist);n.enter().append("div").classed("bar",!0);var r=a.scale.ordinal().domain(a.range(t.hist.length).map(String)).rangeBands([0,100],.1),i=a.scale.linear().domain([0,t.maxBin]).range([0,100]);n.style({left:function(t,e){return r(String(e))+"%"},width:function(t,e){return r.rangeBand()+"%"},top:function(t){return 100-i(t.y)+"%"},height:function(t){return i(t.y)+"%"}}).attr({title:function(t,e){return"Bin "+e+": "+t.y},"data-x":function(t){return t.x}}),n.exit().remove();var o=e.select("div.mean");o.empty()&&(o=e.append("div").classed("mean",!0)),o.style("left",100*t.mean+"%")})})),f.exit().remove()},t}();e.c=_},function(t,e,n){"use strict";function r(t,e,n,r,i){switch(void 0===t&&(t="svg"),void 0===i&&(i={}),t){case"svg":return new s.a(e,n,r,i);case"html":return new c.a(e,n,r,i);case"canvas":return new l.a(e,n,r,i);default:return new s.a(e,n,r,i)}}var i=n(25);Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"HeaderRenderer",function(){return i.c}),n.d(e,"IRankingHook",function(){return i.IRankingHook}),n.d(e,"dummyRankingButtonHook",function(){return i.b}),n.d(e,"PoolRenderer",function(){return o.a});var o=n(39);n.d(e,"IBodyRenderer",function(){return a.IBodyRenderer}),n.d(e,"ISlicer",function(){return a.ISlicer});var a=n(16),s=n(40),c=n(38),l=n(37);e.createBodyRenderer=r},function(t,e,n){"use strict";function r(t,e){return'<span style="font-weight: bold" class="lu-popup-title">'+t+'</span><form onsubmit="return false">'+e+'<button type = "submit" class="ok fa fa-check" title="ok"></button><button type = "reset" class="cancel fa fa-times" title="cancel"></button><button type = "button" class="reset fa fa-undo" title="reset"></button></form>'}function i(t,e,i){function o(){s.style({left:this.parentElement.offsetLeft+N.event.dx+"px",top:this.parentElement.offsetTop+N.event.dy+"px"})}var a=n.i(T.offset)(t.node()),s=n.i(N.select)("body").append("div").attr({class:"lu-popup2"}).style({left:a.left+"px",top:a.top+"px"}).html(r(e,i));s.select("span.lu-popup-title").call(N.behavior.drag().on("drag",o)),s.on("keydown",function(){27===N.event.which&&s.remove()});var c=s.select("input[autofocus]").node();return c&&c.focus(),s}function o(t,e){var n=i(e,"Rename Column",'\n    <input type="text" size="15" value="'+t.label+'" required="required" autofocus="autofocus"><br>\n    <input type="color" size="15" value="'+t.color+'" required="required"><br>\n    <textarea rows="5">'+t.description+"</textarea><br>");n.select(".ok").on("click",function(){var e=n.select('input[type="text"]').property("value"),r=n.select('input[type="color"]').property("value"),i=n.select("textarea").property("value");t.setMetaData({label:e,color:r,description:i}),n.remove()}),n.select(".cancel").on("click",function(){n.remove()})}function a(t,e,n,r){void 0===n&&(n=[]);var o='<input type="text" size="15" value="'+t.getLink()+'" required="required" autofocus="autofocus" '+(n.length>0?'list="ui'+r+'lineupPatternList"':"")+"><br>";n.length>0&&(o+='<datalist id="ui${idPrefix}lineupPatternList">'+n.map(function(t){return'<option value="'+t+'">'})+"</datalist>");var a=i(e,"Edit Link ($ as Placeholder)",o);a.select(".ok").on("click",function(){var e=a.select('input[type="text"]').property("value");t.setLink(e),a.remove()}),a.select(".cancel").on("click",function(){a.remove()})}function s(t,e,n){function r(){var e=o.select('input[type="text"]').property("value"),r=o.select('input[type="text"]').property("checked");e.length>0&&(r&&(e=new RegExp(e)),n.searchAndJump(e,t)),o.remove()}var o=i(e,"Search",'<input type="text" size="15" value="" required="required" autofocus="autofocus"><br><label><input type="checkbox">RegExp</label><br>');o.select('input[type="text"]').on("input",function(){var e=this.value;if(e.length>=3){var r=o.select('input[type="checkbox"]').property("checked");r&&(e=new RegExp(e)),n.searchAndJump(e,t)}}),o.select('input[type="checkbox"]').on("change",r),o.select(".ok").on("click",r),o.select(".cancel").on("click",function(){o.remove()})}function c(t,e){function n(){c.select(".bar").transition().style("width",function(t){return a(t.weight)+"px"})}var r=t.getWeights(),o=t.children.map(function(t,e){return{col:t,weight:100*r[e]}}),a=N.scale.linear().domain([0,100]).range([0,120]),s=i(e,"Edit Weights","<table></table>"),c=s.select("table").selectAll("tr").data(o),l=c.enter().append("tr");l.append("td").append("input").attr({type:"number",value:function(t){return t.weight},min:0,max:100,size:5}).on("input",function(t){t.weight=+this.value,n()}),l.append("td").append("div").attr("class",function(t){return"bar "+t.col.cssClass}).style("background-color",function(t){return t.col.color}),l.append("td").text(function(t){return t.col.label}),n(),s.select(".cancel").on("click",function(){t.setWeights(r),s.remove()}),s.select(".reset").on("click",function(){o.forEach(function(t,e){return t.weight=100*r[e]}),c.select("input").property("value",function(t){return t.weight}),n()}),s.select(".ok").on("click",function(){t.setWeights(o.map(function(t){return t.weight})),s.remove()})}function l(t,e){void 0===e&&(e=!1),t.classed("filtered",e)}function u(t){return function(e,n){var r=e[t],i=n[t];return r.toLowerCase()<i.toLowerCase()?-1:r.toLowerCase()>i.toLowerCase()?1:0}}function p(t,e){function n(){d.select(".checkmark").html(function(t){return'<i class="fa fa-'+(t.isChecked?"check-":"")+'square-o"></i>'}),d.select(".datalabel").style("opacity",function(t){return t.isChecked?"1.0":".8"})}function r(){s.select(".selectAll").html(function(t){return'<i class="fa fa-'+(g?"check-":"")+'square-o"></i>'}),s.select("thead").on("click",function(){g=!g,h.forEach(function(t){return t.isChecked=g}),n(),r()})}function o(n){l(e,n&&n.length>0&&n.length<h.length),t.setFilter(n)}var a=t.getFilter()||[],s=i(e,"Edit Filter",'<div class="selectionTable"><table><thead><th class="selectAll"></th><th>Category</th></thead><tbody></tbody></table></div>'),c=t.categoryColors,p=t.categoryLabels,h=t.categories.map(function(t,e){return{cat:t,label:p[e],isChecked:0===a.length||a.indexOf(t)>=0,color:c[e]}}).sort(u("label")),d=s.select("tbody").selectAll("tr").data(h),f=d.enter().append("tr");f.append("td").attr("class","checkmark"),f.append("td").attr("class","datalabel").text(function(t){return t.label}),f.on("click",function(t){t.isChecked=!t.isChecked,n()}),n();var g=!0;r(),s.select(".cancel").on("click",function(){o(a),s.remove()}),s.select(".reset").on("click",function(){h.forEach(function(t){return t.isChecked=!0}),n(),o(null)}),s.select(".ok").on("click",function(){var t=h.filter(function(t){return t.isChecked}).map(function(t){return t.cat});t.length===h.length&&(t=[]),o(t),s.remove()})}function h(t,e){function n(n){l(e,n&&""!==n),t.setFilter(n)}function r(t){var e=s.select('input[type="text"]').property("value"),r=s.select('input[type="checkbox"].lu_filter_missing').property("checked");if(r&&""===e&&(e=y.a.FILTER_MISSING),""===e)return void n(e);if(e.length>=3||t){var i=s.select('input[type="checkbox"]:first-of-type').property("checked");i&&e!==y.a.FILTER_MISSING&&(e=new RegExp(e)),n(e)}}var o=t.getFilter()||"",a=o===y.a.FILTER_MISSING;a&&(o="");var s=i(e,"Filter",'<input type="text" placeholder="containing..." autofocus="true" size="15" value="'+(o instanceof RegExp?o.source:o)+'" autofocus="autofocus">\n    <br><label><input type="checkbox" '+(o instanceof RegExp?'checked="checked"':"")+'>RegExp</label><br><label><input class="lu_filter_missing" type="checkbox" '+(a?'checked="checked"':"")+">Filter Missing</label>\n    <br>");s.selectAll('input[type="checkbox"]').on("change",r),s.select('input[type="text"]').on("input",r),s.select(".cancel").on("click",function(){s.select('input[type="text"]').property("value",o||""),s.select('input[type="checkbox"]:first-of-type').property("checked",o instanceof RegExp?"checked":null),s.select('input[type="checkbox"].lu_filter_missing').property("checked",a?"checked":null),n(o),s.remove()}),s.select(".reset").on("click",function(){s.select('input[type="text"]').property("value",""),s.selectAll('input[type="checkbox"]').property("checked",null),n(null)}),s.select(".ok").on("click",function(){r(!0),s.remove()})}function d(t,e){function n(n){l(e,null!==n),t.setFilter(n)}function r(){var t=a.select('input[type="radio"][value="true"]').property("checked"),e=a.select('input[type="radio"][value="false"]').property("checked");n(!!t||!e&&null)}var o=t.getFilter(),a=i(e,"Filter",'<label><input type="radio" name="boolean_check" value="null" '+(null===o?'checked="checked"':"")+'>No Filter</label><br>\n     <label><input type="radio" name="boolean_check" value="true" '+(o===!0?'checked="checked"':"")+'>True</label><br>\n     <label><input type="radio" name="boolean_check" value="false" '+(o===!1?'checked="checked"':"")+">False</label>\n    <br>");a.selectAll('input[type="radio"]').on("change",r),a.select(".cancel").on("click",function(){n(o),a.remove()}),a.select(".reset").on("click",function(){var t=null===o?"null":String(o);a.selectAll('input[type="radio"]').property("checked",function(){return this.value===t}),n(null)}),a.select(".ok").on("click",function(){r(),a.remove()})}function f(t,e){function n(e){t.setScript(e)}function r(){var t=a.select("textarea").property("value");n(t)}var o=t.getScript(),a=i(e,"Edit Script",'Parameters: <code>values: number[], children: Column[]</code><br>\n      <textarea autofocus="true" rows="5" autofocus="autofocus" style="width: 95%;">'+t.getScript()+"</textarea><br>");a.select(".cancel").on("click",function(){a.select("textarea").property("value",o),n(o),a.remove()}),a.select(".reset").on("click",function(){a.select("textarea").property("value",m.a.DEFAULT_SCRIPT),n(m.a.DEFAULT_SCRIPT)}),a.select(".ok").on("click",function(){r(),a.remove()})}function g(t,e,i,o){function a(n,r){h=n,d=r,l(e,!n.eq(c)||u.min!==r.min||u.max!==r.min||u.filterMissing!==r.filterMissing),t.setMapping(n),t.setFilter(r)}var s=n.i(T.offset)(e.node()),c=t.getOriginalMapping(),u=t.getFilter(),p=t.getMapping(),h=p.clone(),d=u,f=n.i(N.select)("body").append("div").attr({class:"lu-popup"}).style({left:s.left+"px",top:s.top+"px"}).html(r("Change Mapping",'<div class="mappingArea"></div>')),g={idPrefix:o,callback:a,triggerCallback:"dragend"},E=i.mappingSample(t),v=new b.a(f.select(".mappingArea").node(),h,c,d,E,g);f.select(".ok").on("click",function(){a(v.scale,v.filter),f.remove()}),f.select(".cancel").on("click",function(){t.setMapping(p),l(e,!p.eq(c)),f.remove()}),f.select(".reset").on("click",function(){p=c,h=p.clone(),u=_.c.noFilter(),d=u,a(h,d),f.selectAll(".mappingArea *").remove(),v=new b.a(f.select(".mappingArea").node(),h,c,d,E,g)})}function E(t,e){function n(){g.select(".checkmark").html(function(t){return'<i class="fa fa-'+(t.isChecked?"check-":"")+'square-o"></i>'}),g.select(".bar").transition().style("width",function(t){return s(t.range)+"px"}),g.select(".datalabel").style("opacity",function(t){return t.isChecked?"1.0":".8"})}function r(){c.select(".selectAll").html(function(t){return'<i class="fa fa-'+(v?"check-":"")+'square-o"></i>'}),c.select("thead").on("click",function(){v=!v,f.forEach(function(t){return t.isChecked=v}),n(),r()})}function o(n){l(e,n&&n.length>0&&n.length<f.length),t.setFilter(n)}var a=t.getFilter()||[],s=N.scale.linear().domain([0,100]).range([0,120]),c=i(e,"Edit Categorical Mapping",'<div class="selectionTable"><table><thead><th class="selectAll"></th><th colspan="2">Scale</th><th>Category</th></thead><tbody></tbody></table></div>'),p=t.getScale().range,h=t.categoryColors,d=t.categoryLabels,f=t.categories.map(function(t,e){return{cat:t,label:d[e],isChecked:0===a.length||a.indexOf(t)>=0,range:100*p[e],color:h[e]}}).sort(u("label")),g=c.select("tbody").selectAll("tr").data(f),E=g.enter().append("tr");E.append("td").attr("class","checkmark").on("click",function(t){t.isChecked=!t.isChecked,n()}),E.append("td").append("input").attr({type:"number",value:function(t){return t.range},min:0,max:100,size:5}).on("input",function(t){t.range=+this.value,n()}),E.append("td").append("div").attr("class","bar").style("background-color",function(t){return t.color}),E.append("td").attr("class","datalabel").text(function(t){return t.label}),n();var v=!0;r(),c.select(".cancel").on("click",function(){o(a),t.setMapping(p),c.remove()}),c.select(".reset").on("click",function(){f.forEach(function(t){t.isChecked=!0,t.range=50}),n(),o(null),t.setMapping(f.map(function(){return 1}))}),c.select(".ok").on("click",function(){var e=f.filter(function(t){return t.isChecked}).map(function(t){return t.cat});e.length===f.length&&(e=[]),o(e),t.setMapping(f.map(function(t){return t.range/100})),c.remove()})}function v(){return{string:h,categorical:p,number:g,ordinal:E,boolean:d}}var y=n(5),m=n(14),_=n(4),T=n(2),b=n(31),N=n(0);n.n(N);Object.defineProperty(e,"__esModule",{value:!0}),e.dialogForm=r,e.makePopup=i,e.openRenameDialog=o,e.openEditLinkDialog=a,e.openSearchDialog=s,e.openEditWeightsDialog=c,e.openEditScriptDialog=f,e.filterDialogs=v},function(t,e){},function(t,e,n){"use strict";function r(t){return"string"==typeof t&&t.indexOf(".")>=0}function i(t,e){var n=function(t,e){return void 0===t?t:/\d+/.test(e)?t[+e]:t[e]};return t.split(".").reduce(n,e)}function o(t,e,n,o){var a=o.column;return r(a)?i(a,t):t[a]}var a=n(10),s=n(13),c=n(7),l=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},u=function(t){function e(e,n){void 0===e&&(e=[]),void 0===n&&(n={});var r=t.call(this,n)||this;return r.columns=e,r.rankingIndex=0,r.ranks=new Map,e.forEach(function(t){t.accessor=t.accessor||o,t.label=t.label||t.column}),r}return l(e,t),e.prototype.rankAccessor=function(t,e,n,r,i){return this.ranks[i.id].indexOf(e)+1},e.prototype.cloneRanking=function(t){var e=this,r=this.nextRankingId(),i=new s.a(r);return t?(this.ranks[r]=this.ranks[t.id],t.children.forEach(function(t){e.push(i,t.desc)})):i.push(this.create(n.i(a.createRankDesc)())),i},e.prototype.cleanUpRanking=function(t){delete this.ranks[t.id]},e.prototype.sort=function(t){var e=this;return this.sortImpl(t).then(function(n){return e.ranks[t.id]=n,n})},e.prototype.pushDesc=function(t){var e=t;e.accessor=e.accessor||o,e.label=t.label||e.column,this.columns.push(t),this.fire(c.a.EVENT_ADD_DESC,e)},e.prototype.getColumns=function(){return this.columns.slice()},e.prototype.findDesc=function(t){return this.columns.filter(function(e){return e.column===t})[0]},e.prototype.toDescRef=function(t){return t.column?t.type+"@"+t.column:t},e.prototype.fromDescRef=function(t){return"string"==typeof t?this.columns.filter(function(e){return e.type+"@"+e.column===t})[0]:t},e.prototype.restore=function(e){t.prototype.restore.call(this,e),this.rankingIndex=1+Math.max.apply(Math,this.getRankings().map(function(t){return+t.id.substring(4)}))},e.prototype.nextRankingId=function(){return"rank"+this.rankingIndex++},e}(c.a);e.a=u},function(t,e,n){"use strict";function r(t,e,n,r){if(0===t.length)return{min:NaN,max:NaN,mean:NaN,count:0,maxBin:0,hist:[]};var i=function(t,r){return n(t,e[r])},o=s.layout.histogram().value(i);r&&o.range(function(){return r});var a=s.extent(t,i),c=o(t);return{min:a[0],max:a[1],mean:s.mean(t,i),count:t.length,maxBin:s.max(c,function(t){return t.y}),hist:c}}function i(t,e,n,r){var i=new Map;r.forEach(function(t){return i.set(t,0)}),t.forEach(function(t,r){var o=n(t,e[r]);null!=o&&o.forEach(function(t){i.set(t,(i.get(t)||0)+1)})});var o=[];return i.forEach(function(t,e){return o.push({cat:e,y:t})}),{maxBin:Math.max.apply(Math,o.map(function(t){return t.y})),hist:o}}var o=n(1),a=n(2),s=n(0),c=(n.n(s),n(29)),l=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},u=function(t){function e(e,r,i){void 0===r&&(r=[]),void 0===i&&(i={});var o=t.call(this,r,i)||this;o.data=e,o.options={filterGlobally:!1},n.i(a.merge)(o.options,i);var s=o;return o.reorderAll=function(){var t=this.source;s.getRankings().forEach(function(e){e!==t&&e.dirtyOrder()})},o}return l(e,t),e.prototype.setData=function(t){this.data=t,this.reorderAll()},e.prototype.clearData=function(){this.setData([])},e.prototype.appendData=function(t){this.data.push.apply(this.data,t),this.reorderAll()},e.prototype.cloneRanking=function(e){var n=t.prototype.cloneRanking.call(this,e);return this.options.filterGlobally&&n.on(o.a.EVENT_FILTER_CHANGED+".reorderAll",this.reorderAll),n},e.prototype.cleanUpRanking=function(e){this.options.filterGlobally&&e.on(o.a.EVENT_FILTER_CHANGED+".reorderAll",null),t.prototype.cleanUpRanking.call(this,e)},e.prototype.sortImpl=function(t){if(0===this.data.length)return Promise.resolve([]);var e=this.data.map(function(t,e){return{row:t,i:e}});if(this.options.filterGlobally){var n=this.getRankings().filter(function(t){return t.isFiltered()});n.length>0&&(e=e.filter(function(t){return n.every(function(e){return e.filter(t.row,t.i)})}))}else t.isFiltered()&&(e=e.filter(function(e){return t.filter(e.row,e.i)}));return e.sort(function(e,n){return t.comparator(e.row,n.row,e.i,n.i)}),Promise.resolve(e.map(function(t){return t.i}))},e.prototype.viewRaw=function(t){var e=this;this.data.length;return t.map(function(t){return e.data[t]})},e.prototype.view=function(t){return Promise.resolve(this.viewRaw(t))},e.prototype.fetch=function(t){var e=this;this.data.length;return t.map(function(t){return t.map(function(t){return Promise.resolve({v:e.data[t],dataIndex:t})})})},e.prototype.stats=function(t){var e=this,n=null,o=function(){return null===n?n=e.viewRaw(t):n};return{stats:function(e){return Promise.resolve(r(o(),t,e.getNumber.bind(e),[0,1]))},hist:function(e){return Promise.resolve(i(o(),t,e.getCategories.bind(e),e.categories))}}},e.prototype.mappingSample=function(t){var e=this,n=500,r=this.data.length;if(r<=n)return Promise.resolve(this.data.map(t.getRawValue.bind(t)));for(var i=[],o=0;o<n;++o){for(var a=Math.floor(Math.random()*(r-1));i.indexOf(a)>=0;)a=Math.floor(Math.random()*(r-1));i.push(a)}return Promise.resolve(i.map(function(n){return t.getRawValue(e.data[n],n)}))},e.prototype.searchAndJump=function(t,e){var n=this;t="string"==typeof t?t.toLowerCase():t;var r="string"==typeof t?function(e){return e.toLowerCase().indexOf(t)>=0}:t.test.bind(t),i=s.range(this.data.length).filter(function(t){return r(e.getLabel(n.data[t],t))});this.jumpToNearest(i)},e}(c.a);e.a=u},function(t,e,n){"use strict";function r(t,e,n){return Math.max(Math.min(t,n),e)}function i(t){var e=new Set;t.forEach(function(t){return e.add(t)});var n=[];return e.forEach(function(t){return n.push(t)}),n}var o=n(0),a=(n.n(o),n(2)),s=n(4),c=function(){function t(t,e,r,i,s,c){this.parent=t,this.scale_=e,this.original=r,this.old_filter=i,this.dataPromise=s,this.options={idPrefix:"",width:370,height:225,padding_hor:7,padding_ver:7,filter_height:20,radius:5,callback:function(){},callbackThisArg:null,triggerCallback:"change"},n.i(a.merge)(this.options,c),this.scale_=e.clone(),this.build(n.i(o.select)(t))}return Object.defineProperty(t.prototype,"scale",{get:function(){return this.scale_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filter",{get:function(){return this.computeFilter()},enumerable:!0,configurable:!0}),t.prototype.build=function(t){function e(){y.attr({x1:function(t){return v(d.scale.apply(t))},x2:E}).style("visibility",function(t){var e=d.scale.domain;return t<e[0]||t>e[e.length-1]?"hidden":null})}function a(t){return o.behavior.drag().on("dragstart",function(){n.i(o.select)(this).classed("dragging",!0).attr("r",1.1*h.radius)}).on("drag",t).on("dragend",function(){n.i(o.select)(this).classed("dragging",!1).attr("r",h.radius),u(!0)})}function c(){function i(){m.sort(function(t,e){return t.r-e.r});var t=d.scale;t.domain=m.map(function(t){return t.r}),t.range=m.map(function(t){return t.n}),e()}function l(t){m.length<=2||(m.splice(t,1),i(),c())}function u(t){var e=r(t,0,f);m.push({n:v.invert(e),r:E.invert(e)}),i(),c()}if(d.scale instanceof s.d){var p=d.scale,y=p.domain,_=p.range;m=y.map(function(t,e){return{r:t,n:_[e]}}),t.selectAll("rect.adder").on("click",function(){u(n.i(o.mouse)(t.select("svg > g").node())[0])});var T=t.select("g.mappings").selectAll("g.mapping").data(m),b=T.enter().append("g").classed("mapping",!0).on("contextmenu",function(t,e){o.event.preventDefault(),o.event.stopPropagation(),l(e)});b.append("line").attr({y1:0,y2:g}).call(a(function(t){var e=o.event.dx,a=r(v(t.n)+e,0,f),s=r(E(t.r)+e,0,f);t.n=v.invert(a),t.r=E.invert(s),n.i(o.select)(this).attr("x1",a).attr("x2",s),n.i(o.select)(this.parentElement).select("circle.normalized").attr("cx",a),n.i(o.select)(this.parentElement).select("circle.raw").attr("cx",s),i()})),b.append("circle").classed("normalized",!0).attr("r",h.radius).call(a(function(t){var e=r(o.event.x,0,f);t.n=v.invert(e),n.i(o.select)(this).attr("cx",e),n.i(o.select)(this.parentElement).select("line").attr("x1",e),i()})),b.append("circle").classed("raw",!0).attr("r",h.radius).attr("cy",g).call(a(function(t){var e=r(o.event.x,0,f);t.r=E.invert(e),n.i(o.select)(this).attr("cx",e),n.i(o.select)(this.parentElement).select("line").attr("x2",e),i()})),T.select("line").attr({x1:function(t){return v(t.n)},x2:function(t){return E(t.r)}}),T.select("circle.normalized").attr("cx",function(t){return v(t.n)}),T.select("circle.raw").attr("cx",function(t){return E(t.r)}),T.exit().remove()}}function l(){if(!(d.scale instanceof s.e))return void t.select("div.script").style("display","none");t.select("div.script").style("display",null);var n=d.scale,r=t.select("textarea").text(n.code);t.select("div.script").select("button").on("click",function(){n.code=r.property("value"),e(),u()})}function u(t){void 0===t&&(t=!1),t&&"dragend"!==h.triggerCallback||h.callback.call(h.callbackThisArg,d.scale.clone(),d.filter)}function p(){var n=E.domain();t.select("input.raw_min").property("value",n[0]),t.select("input.raw_max").property("value",n[1]),e(),c()}var h=this.options,d=this;t=t.append("div").classed("lugui-me",!0);var f=h.width-2*h.padding_hor,g=h.height-2*h.padding_ver-h.filter_height;t.node().innerHTML='<form onsubmit="return false">\n      <div style="text-align: center"><label for="me'+h.idPrefix+'mapping_type">Mapping Type: <select id="me'+h.idPrefix+'mapping_type">\n        <option value="linear">Linear</option>\n        <option value="linear_invert">Invert</option>\n        <option value="linear_abs">Absolute</option>\n        <option value="log">Log</option>\n        <option value="pow1.1">Pow 1.1</option>\n        <option value="pow2">Pow 2</option>\n        <option value="pow3">Pow 3</option>\n        <option value="sqrt">Sqrt</option>\n        <option value="script">Custom Script</option>\n      </select>\n      </label></div>\n      <div class="mapping_area">\n        <div>\n          <span>0</span>\n          <input type="text" class="raw_min" id="me'+h.idPrefix+'raw_min" value="0"><label for="me'+h.idPrefix+'raw_min">Min</label>\n        </div>\n        <svg width="'+h.width+'" height="'+h.height+'">\n          <line y1="'+h.padding_ver+'" y2="'+h.padding_ver+'" x1="'+h.padding_hor+'" x2="'+(f+h.padding_hor)+'" stroke="black"></line>\n          <rect class="adder" x="'+h.padding_hor+'" width="'+f+'" height="10"></rect>\n          <line y1="'+(h.height-h.filter_height-5)+'" y2="'+(h.height-h.filter_height-5)+'" x1="'+h.padding_hor+'" x2="'+(f+h.padding_hor)+'" stroke="black"></line>\n          <rect class="adder" x="'+h.padding_hor+'" width="'+f+'" height="10" y="'+(h.height-h.filter_height-10)+'"></rect>\n          <g transform="translate('+h.padding_hor+","+h.padding_ver+')">\n            <g class="samples">\n      \n            </g>\n            <g class="mappings">\n      \n            </g>\n            <g class="filter" transform="translate(0,'+(h.height-h.filter_height-10)+')">\n               <g class="left_filter" transform="translate(0,0)">\n                  <path d="M0,0L4,7L-4,7z"></path>\n                  <rect x="-4" y="7" width="40" height="13" rx="2" ry="2"></rect>\n                  <text y="10" x="4" text-anchor="start">&gt; 0</text>\n              </g>\n              <g class="right_filter" transform="translate('+f+',0)">\n                  <path d="M0,0L4,7L-4,7z"></path>\n                  <rect x="-36" y="7" width="40" height="13" rx="2" ry="2"></rect>\n                  <text y="10" x="3" text-anchor="end">&lt; 1</text>\n              </g>\n            </g>\n          </g>\n        </svg>\n        <div>\n          <span>1</span>\n          <input type="text" class="raw_max" id="me'+h.idPrefix+'raw_max" value="1"><label for="me'+h.idPrefix+'raw_max">Max</label>\n        </div>\n      </div>\n      <div>\n         Extras: <label><input type="checkbox" id="me'+h.idPrefix+'filterMissing" '+(this.old_filter.filterMissing?'checked="checked"':"")+'>Filter Missing Values</label>\n      </div>\n      <div class="script" style="/* display: none; */">\n        <label for="me'+h.idPrefix+'script_code">Custom Script</label><button>Apply</button>\n        <textarea id="me'+h.idPrefix+'script_code">\n        </textarea>\n      </div>\n    </form>';var E=o.scale.linear().domain([Math.min(this.scale.domain[0],this.original.domain[0]),Math.max(this.scale.domain[this.scale.domain.length-1],this.original.domain[this.original.domain.length-1])]).range([0,f]),v=o.scale.linear().domain([0,1]).range([0,f]);t.select("input.raw_min").property("value",E.domain()[0]).on("blur",function(){var t=E.domain();t[0]=parseFloat(this.value),E.domain(t);var e=d.scale_.domain;e[0]=t[0],d.scale_.domain=e,p(),u()}),t.select("input.raw_max").property("value",E.domain()[1]).on("blur",function(){var t=E.domain();t[1]=parseFloat(this.value),E.domain(t);var e=d.scale_.domain;e[e.length-1]=t[1],d.scale_.domain=e,p(),u()}),t.select('input[type="checkbox"]').on("change",function(){u()});var y=t.select("g.samples").selectAll("line").data([]);this.dataPromise.then(function(t){t=i(t),y=y.data(t),y.enter().append("line").attr({x1:function(t){return v(d.scale.apply(t))},y1:0,x2:E,y2:g}).style("visibility",function(t){var e=d.scale.domain;return t<e[0]||t>e[e.length-1]?"hidden":null})});var m=[];c(),l();var _=isFinite(this.old_filter.min)?E(this.old_filter.min):0,T=isFinite(this.old_filter.max)?E(this.old_filter.max):f,b=function(t,e){return isFinite(t)?(0===e?">":"<")+t.toFixed(1):"any"};t.selectAll("g.left_filter, g.right_filter").data([this.old_filter.min,this.old_filter.max]).attr("transform",function(t,e){return"translate("+(0===e?_:T)+",0)"}).call(a(function(t,e){var i=r(o.event.x,0,f),a=E.invert(i),s=i<=0&&0===e?-(1/0):i>=f&&1===e?1/0:a;n.i(o.select)(this).datum(s).attr("transform","translate("+i+",0)").select("text").text(b(s,e))})).select("text").text(b),this.computeFilter=function(){return{min:parseFloat(t.select("g.left_filter").datum()),max:parseFloat(t.select("g.right_filter").datum()),filterMissing:t.select('input[type="checkbox"]').property("checked")}},p(),t.select("select").on("change",function(){var t=this.value;if("linear_invert"===t)d.scale_=new s.d(E.domain(),"linear",[1,0]);else if("linear_abs"===t){var n=E.domain();d.scale_=new s.d([n[0],(n[1]-n[0])/2,n[1]],"linear",[1,0,1]);
}else"script"===t?d.scale_=new s.e(E.domain()):d.scale_=new s.d(E.domain(),t);e(),c(),l(),u()}).property("selectedIndex",function(){var t="script";d.scale_ instanceof s.d&&(t=d.scale.scaleType);var e=["linear","linear_invert","linear_abs","log","pow1.1","pow2","pow3","sqrt","script"];return e.indexOf(t)})},t}();e.a=c},function(t,e,n){"use strict";var r=n(1),i=n(5),o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.annotations=new Map,r}return o(e,t),e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat([e.EVENT_VALUE_CHANGED])},e.prototype.getValue=function(e,n){return this.annotations.has(n)?this.annotations.get(n):t.prototype.getValue.call(this,e,n)},e.prototype.dump=function(e){var n=t.prototype.dump.call(this,e);return n.annotations={},this.annotations.forEach(function(t,e){n.annotations[e]=t}),n},e.prototype.restore=function(e,n){var r=this;t.prototype.restore.call(this,e,n),e.annotations&&Object.keys(e.annotations).forEach(function(t){r.annotations.set(Number(t),e.annotations[t])})},e.prototype.setValue=function(t,n,i){var o=this.getValue(t,n);return o===i||(""===i||null==i?this.annotations.delete(n):this.annotations.set(n,i),this.fire([e.EVENT_VALUE_CHANGED,r.a.EVENT_DIRTY_VALUES,r.a.EVENT_DIRTY],n,o,i),!0)},e}(i.a);e.a=a,a.EVENT_VALUE_CHANGED="valueChanged"},function(t,e,n){"use strict";var r=n(0),i=(n.n(r),n(1)),o=n(3),a=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},s=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.currentFilter=null,r.trueMarker="X",r.falseMarker="",r.setWidthImpl(30),r.trueMarker=n.trueMarker||r.trueMarker,r.falseMarker=n.falseMarker||r.falseMarker,r}return a(e,t),e.prototype.getValue=function(e,n){var r=t.prototype.getValue.call(this,e,n);return"undefined"!=typeof r&&null!=r&&(r===!0||"true"===r||"yes"===r||"x"===r)},e.prototype.getLabel=function(t,e){var n=this.getValue(t,e);return n?this.trueMarker:this.falseMarker},e.prototype.dump=function(e){var n=t.prototype.dump.call(this,e);return null!==this.currentFilter&&(n.filter=this.currentFilter),n},e.prototype.restore=function(e,n){t.prototype.restore.call(this,e,n),"undefined"!=typeof e.filter&&(this.currentFilter=e.filter)},e.prototype.isFiltered=function(){return null!==this.currentFilter},e.prototype.filter=function(t,e){if(!this.isFiltered())return!0;var n=this.getValue(t,e);return n===this.currentFilter},e.prototype.getFilter=function(){return this.currentFilter},e.prototype.setFilter=function(t){this.currentFilter!==t&&this.fire([i.a.EVENT_FILTER_CHANGED,i.a.EVENT_DIRTY_VALUES,i.a.EVENT_DIRTY],this.currentFilter,this.currentFilter=t)},e.prototype.compare=function(t,e,i,o){return n.i(r.ascending)(this.getValue(t,i),this.getValue(e,o))},e}(o.a);e.a=s},function(t,e,n){"use strict";var r=n(0),i=(n.n(r),n(1)),o=n(3),a=n(11),s=n(4),c=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},l=function(t){function e(e,n){var i=t.call(this,e,n)||this;if(i.colors=r.scale.category10(),i.catLabels=new Map,i.scale=r.scale.ordinal().rangeRoundPoints([0,1]),i.currentFilter=null,i.separator=";",i.combiner=r.max,i.separator=n.separator||i.separator,a.a.prototype.initCategories.call(i,n),i.scale.domain(i.colors.domain()),n.categories){var o=n.categories.map(function(t){return"string"!=typeof t&&"number"==typeof t.value?t.value:.5});i.scale.range(o)}return i}return c(e,t),e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat([e.EVENT_MAPPING_CHANGED])},Object.defineProperty(e.prototype,"categories",{get:function(){return this.colors.domain().slice()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"categoryColors",{get:function(){return this.colors.range().slice()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"categoryLabels",{get:function(){var t=this;return null===this.catLabels||0===this.catLabels.size?this.categories:this.categories.map(function(e){return t.catLabels.has(e)?t.catLabels.get(e):e})},enumerable:!0,configurable:!0}),e.prototype.colorOf=function(t){return this.colors(t)},e.prototype.getLabel=function(t,e){return a.a.prototype.getLabel.call(this,t,e)},e.prototype.getFirstLabel=function(t,e){return a.a.prototype.getFirstLabel.call(this,t,e)},e.prototype.getLabels=function(t,e){return a.a.prototype.getLabels.call(this,t,e)},e.prototype.getValue=function(t,e){var n=this.getValues(t,e);return n.length>0?this.combiner(n):0},e.prototype.getValues=function(t,e){var n=a.a.prototype.getValues.call(this,t,e);return n.map(this.scale)},e.prototype.getCategories=function(t,e){return a.a.prototype.getValues.call(this,t,e)},e.prototype.getNumber=function(t,e){return this.getValue(t,e)},e.prototype.getColor=function(t,e){var n=this.getValues(t,e),i=this.getColors(t,e);return this.combiner===r.max?i.slice(1).reduce(function(t,e,r){return n[r+1]>t.v?{c:e,v:n[r+1]}:t},{c:i[0],v:n[0]}).c:this.combiner===r.min?i.slice(1).reduce(function(t,e,r){return n[r+1]<t.v?{c:e,v:n[r+1]}:t},{c:i[0],v:n[0]}).c:i[0]||null},e.prototype.getColors=function(t,e){return a.a.prototype.getColors.call(this,t,e)},e.prototype.dump=function(t){var e=a.a.prototype.dump.call(this,t);return e.scale={domain:this.scale.domain(),range:this.scale.range(),separator:this.separator},e},e.prototype.restore=function(t,e){a.a.prototype.restore.call(this,t,e),t.scale&&this.scale.domain(t.scale.domain).range(t.scale.range),this.separator=t.separator||this.separator},e.prototype.getScale=function(){return{domain:this.scale.domain(),range:this.scale.range()}},e.prototype.getMapping=function(){return this.scale.range().slice()},e.prototype.setMapping=function(t){var n=this.getScale();this.scale.range(t),this.fire([e.EVENT_MAPPING_CHANGED,i.a.EVENT_DIRTY_VALUES,i.a.EVENT_DIRTY],n,this.getScale())},e.prototype.isFiltered=function(){return null!=this.currentFilter},e.prototype.filter=function(t,e){return a.a.prototype.filter.call(this,t,e)},e.prototype.getFilter=function(){return this.currentFilter},e.prototype.setFilter=function(t){this.currentFilter!==t&&this.fire([i.a.EVENT_FILTER_CHANGED,i.a.EVENT_DIRTY_VALUES,i.a.EVENT_DIRTY],this.currentFilter,this.currentFilter=t)},e.prototype.compare=function(t,e,n,r){return s.c.prototype.compare.call(this,t,e,n,r)},e.prototype.rendererType=function(){return s.c.prototype.rendererType.call(this)},e}(o.a);e.a=l,l.EVENT_MAPPING_CHANGED=s.c.EVENT_MAPPING_CHANGED},function(t,e,n){"use strict";var r=n(1),i=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=function(t){function e(e,n){return t.call(this,e,n)||this}return i(e,t),e.prototype.getLabel=function(t){return""},e.prototype.getValue=function(t){return""},e.prototype.compare=function(t,e){return 0},e}(r.a);e.a=o},function(t,e,n){"use strict";var r=n(8),i=n(1),o=n(15),a=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},s=function(t){function e(e,n){var r=t.call(this,e,n)||this;r.collapsed=!1;var i=r;return r.adaptChange=function(t,e){i.adaptWidthChange(t,e)},r}return a(e,t),e.prototype.createEventList=function(){return t.prototype.createEventList.call(this).concat([e.EVENT_COLLAPSE_CHANGED])},e.prototype.setCollapsed=function(t){this.collapsed!==t&&this.fire([o.a.EVENT_COLLAPSE_CHANGED,i.a.EVENT_DIRTY_HEADER,i.a.EVENT_DIRTY_VALUES,i.a.EVENT_DIRTY],this.collapsed,this.collapsed=t)},e.prototype.getCollapsed=function(){return this.collapsed},e.prototype.dump=function(e){var n=t.prototype.dump.call(this,e);return n.collapsed=this.collapsed,n},e.prototype.restore=function(e,n){this.collapsed=e.collapsed===!0,t.prototype.restore.call(this,e,n)},e.prototype.flatten=function(t,e,n,r){return void 0===n&&(n=0),void 0===r&&(r=0),o.a.prototype.flatten.call(this,t,e,n,r)},e.prototype.insert=function(e,n){return e.on(i.a.EVENT_WIDTH_CHANGED+".stack",this.adaptChange),t.prototype.setWidth.call(this,0===this.length?e.getWidth():this.getWidth()+e.getWidth()),t.prototype.insert.call(this,e,n)},e.prototype.adaptWidthChange=function(e,n){e!==n&&t.prototype.setWidth.call(this,this.getWidth()+(n-e))},e.prototype.removeImpl=function(e){return e.on(i.a.EVENT_WIDTH_CHANGED+".stack",null),t.prototype.setWidth.call(this,1===this.length?100:this.getWidth()-e.getWidth()),t.prototype.removeImpl.call(this,e)},e.prototype.setWidth=function(e){var n=this.length/this.getWidth();this._children.forEach(function(t){t.setWidthImpl(t.getWidth()*n)}),t.prototype.setWidth.call(this,e)},e.prototype.rendererType=function(){return this.getCollapsed()?e.EVENT_COLLAPSE_CHANGED:t.prototype.rendererType.call(this)},e}(r.a);e.a=s,s.EVENT_COLLAPSE_CHANGED=o.a.EVENT_COLLAPSE_CHANGED},function(t,e,n){"use strict";var r=n(0),i=(n.n(r),n(2)),o=n(17),a=n(6),s=n(16),c=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},l=function(t){function e(r,o,a,s){void 0===s&&(s={});var c=t.call(this,r,o,a,"div",n.i(i.merge)({},e.CUSTOM_OPTIONS,s))||this;return c.currentFreezeLeft=0,c.currentHover=-1,c.lastShifts=[],c.$node.append("canvas"),c.initInteraction(),c}return c(e,t),e.prototype.columnUnderMouse=function(t){for(var e=0,n=this.lastShifts;e<n.length;e++){var r=n[e];if(r.shift<=t&&t<r.shift+r.column.getWidth())return r.column}return null},e.prototype.rowUnderMouse=function(t){var e=this.options.rowHeight;return Math.floor((t+1)/e)},e.prototype.itemUnderMouse=function(t){var e=this.rowUnderMouse(t[1]);if(e<0)return null;var n=this.columnUnderMouse(t[0]);if(null===n)return null;var r=n.findMyRanker().getOrder();return{dataIndex:r[e],column:n}},e.prototype.initInteraction=function(){var t=this;this.$node.on("selectstart",function(){return r.event.preventDefault()}),this.$node.on("mousemove",function(){var e=n.i(r.mouse)(t.node),i=t.itemUnderMouse(e);t.mouseOver(i?i.dataIndex:-1)}),this.$node.on("mouseenter",function(){t.mouseOver(-1,!1)}),this.$node.on("mouseleave",function(){t.mouseOver(-1,!1)}),this.$node.on("click",function(){var e=n.i(r.mouse)(t.node),i=t.itemUnderMouse(e);i&&t.select(i.dataIndex,r.event.ctrlKey||i.column instanceof o.a)})},e.prototype.style=function(t){var e=this.options;return(e.style||{})[t]},e.prototype.select=function(e,n){void 0===n&&(n=!1);var r=t.prototype.select.call(this,e,n);return this.update(),r},e.prototype.drawSelection=function(){this.update()},e.prototype.updateFreeze=function(t){this.currentFreezeLeft=t,this.update()},e.prototype.mouseOver=function(e,r){void 0===r&&(r=!0),r!==(this.currentHover===e)&&(this.currentHover=e,t.prototype.mouseOver.call(this,e,e>=0),(!r||e<0)&&n.i(a.hideOverlays)(),this.update())},e.prototype.isHovered=function(t){return this.currentHover===t},e.prototype.renderRow=function(t,e,n,r,i){var o=r.dataIndex,a=n.shift,s=e.cellY(i);t.translate(a,s),i%2===0&&(t.fillStyle=this.style("bg"),t.fillRect(0,0,n.width,e.rowHeight(i)),t.fillStyle=this.style("text"));var c=this.data.isSelected(o);c?(t.strokeStyle=this.style("selection"),t.strokeRect(0,0,n.width,e.rowHeight(i))):this.isHovered(o)&&(t.strokeStyle=this.style("hover"),t.strokeRect(0,0,n.width,e.rowHeight(i))),t.save();var l=this.currentFreezeLeft<n.shift?0:Math.min(this.currentFreezeLeft-n.shift,n.width-n.frozenWidth);n.frozenWidth>0&&l>0&&(t.rect(a+l+n.frozenWidth,0,n.width,e.rowHeight(i)),t.clip()),n.columns.forEach(function(e){t.save(),t.translate(e.shift,0),e.renderer(t,r,i,a+e.shift,s),t.restore()}),t.restore(),t.translate(l,0),a+=l,n.frozen.forEach(function(e){t.save(),t.translate(e.shift,0),e.renderer(t,r,i,a+e.shift,s),t.restore()}),t.translate(-a,-s)},e.prototype.renderMeanlines=function(t,e,n){var r=this,i=e.columns.filter(function(t){return r.showMeanLine(t.column)});return Promise.all(i.map(function(e){var i=r.histCache.get(e.column.id);if(i)return i.then(function(i){var o=e.shift+e.column.getWidth()*i.mean;isNaN(o)||(t.strokeStyle=r.style("meanLine"),t.beginPath(),t.moveTo(o,0),t.lineTo(o,n),t.stroke())})}))},e.prototype.renderRankings=function(t,e,n,r){var i=this,o=this.renderRow.bind(this,t,n),a=Promise.all.bind(Promise);return a(e.map(function(e){var n=e.data;return a(n.map(function(t,n){return t.then(function(t){return o(e,t,n)})})).then(function(){return i.renderMeanlines(t,e,r)})}))},e.prototype.renderSlopeGraphs=function(t,e,n){var r=this,i=e.slice(1).map(function(t,n){return{left:e[n].order,left_i:n,right:t.order,right_i:n+1}});t.save(),t.strokeStyle=this.style("slope"),i.forEach(function(i,o){t.save(),t.translate(e[o+1].shift-r.options.slopeWidth,0);var a=new Map;i.right.forEach(function(t,e){a.set(t,e)});var s=i.left.map(function(t,e){return{data_index:t,lpos:e,rpos:a.get(t)}}).filter(function(t){return null!=t.rpos});s.forEach(function(e){var i=r.data.isSelected(e.data_index),o=r.isHovered(e.data_index);i?t.strokeStyle=r.style("selection"):o&&(t.strokeStyle=r.style("hover")),t.beginPath(),t.moveTo(0,.5*n.rowHeight(e.lpos)+n.cellY(e.lpos)),t.lineTo(r.options.slopeWidth,.5*n.rowHeight(e.rpos)+n.cellY(e.rpos)),t.stroke(),(i||o)&&(t.strokeStyle=r.style("slope"))}),t.restore()}),t.restore()},e.prototype.createContextImpl=function(t){var e=this,n=this.createContext(t,a.createCanvas);return n.hovered=this.isHovered.bind(this),n.selected=function(t){return e.data.isSelected(t)},n},e.prototype.computeShifts=function(t){var e=this,n=[];return t.forEach(function(t){var r=t.shift;n.push.apply(n,t.frozen.map(function(t){return{column:t.column,shift:t.shift+r+e.currentFreezeLeft}})),n.push.apply(n,t.columns.map(function(t){return{column:t.column,shift:t.shift+r}}))}),n},e.prototype.updateImpl=function(t,e,r,o,a){var s=this.$node.select("canvas"),c=Math.max(e.cellY(0)-20,0),l=Math.min(e.cellY(Math.max.apply(Math,t.map(function(t){return t.order.length})))+20,o);this.$node.style({width:Math.max(0,r)+"px",height:o+"px"}),s.attr({width:Math.max(0,r),height:l-c}).style("margin-top",c+"px"),this.lastShifts=this.computeShifts(t);var u=s.node().getContext("2d");return u.save(),u.font=this.style("font"),u.textBaseline="top",u.fillStyle=this.style("text"),u.clearRect(0,0,u.canvas.width,u.canvas.height),e.textHints=n.i(i.createTextHints)(u,this.style("font")),u.translate(0,-c),this.renderSlopeGraphs(u,t,e),this.renderRankings(u,t,e,o).then(function(){u.restore()})},e}(s.a);e.a=l,l.CUSTOM_OPTIONS={style:{text:"black",font:'10pt "Helvetica Neue", Helvetica, Arial, sans-serif',slope:"darkgray",link:"blue",selection:"#ffa500",hover:"#e5e5e5",bg:"#f7f7f7",meanLine:"darkgray"}}},function(t,e,n){"use strict";var r=n(6),i=n(24),o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a={root:"div",g:"div",setSize:function(t,e,n){t.style.width=e+"px",t.style.height=n+"px"},bg:"div",updateBG:function(t,e){t.style({height:function(t,n,r){return e(t,n,r)[1]+"px"},width:function(t,n,r){return e(t,n,r)[0]+"px"}})},meanLine:"div",updateMeanLine:function(t,e,n){t.style("left",e+"px").style("height",n+"px")},slopes:"svg",updateSlopes:function(t,e,n,r){t.attr("width",e).attr("height",n).style("left",function(t,e){return r(t,e)+"px"})},creator:r.createHTML,translate:function(t,e,n){return t.style.transform="translate("+e+"px,"+n+"px)"},transform:function(t,e){t.style("transform",function(t,n){var r=e(t,n);return"translate("+r[0]+"px,"+r[1]+"px)"})}},s=function(t){function e(e,n,r,i){return void 0===i&&(i={}),t.call(this,e,n,r,a,i)||this}return o(e,t),e.prototype.updateClipPaths=function(t,e,n){},e}(i.a);e.a=s},function(t,e,n){"use strict";var r=n(0),i=(n.n(r),n(2)),o=n(10),a=n(7),s=n(25),c=function(){function t(t){this.desc=t,this.used=0}return t}(),l=function(){function t(t,e,o){void 0===o&&(o={}),this.data=t,this.options={layout:"vertical",elemWidth:100,elemHeight:40,width:100,height:500,additionalDesc:[],hideUsed:!0,addAtEndOnClick:!1},n.i(i.merge)(this.options,o),this.$node=n.i(r.select)(e).append("div").classed("lu-pool",!0),this.changeDataStorage(t)}return t.prototype.changeDataStorage=function(t){var e=this;if(this.data&&this.data.on([a.a.EVENT_ADD_COLUMN+".pool",a.a.EVENT_REMOVE_COLUMN+".pool",a.a.EVENT_ADD_RANKING+".pool",a.a.EVENT_REMOVE_RANKING+".pool",a.a.EVENT_ADD_DESC+".pool"],null),this.data=t,this.entries=t.getColumns().concat(this.options.additionalDesc).map(function(t){return new c(t)}),t.on(a.a.EVENT_ADD_DESC+".pool",function(t){e.entries.push(new c(t)),e.update()}),this.options.hideUsed){var n=this;t.on([a.a.EVENT_ADD_COLUMN+".pool",a.a.EVENT_REMOVE_COLUMN+".pool"],function(t){var e=t.desc,r="addColumn"===this.type?1:-1;n.entries.some(function(t){return t.desc===e&&(t.used+=r,!0)}),n.update()}),t.on([a.a.EVENT_ADD_RANKING+".pool",a.a.EVENT_REMOVE_RANKING+".pool"],function(t){var e=t.flatColumns.map(function(t){return t.desc}),r="addRanking"===this.type?1:-1;n.entries.some(function(t){return!(e.indexOf(t.desc)<0)&&(t.used+=r,!0)}),n.update()}),t.getRankings().forEach(function(t){var e=t.flatColumns.map(function(t){return t.desc}),r=1;n.entries.some(function(t){return!(e.indexOf(t.desc)<0)&&void(t.used+=r)})})}},t.prototype.remove=function(){this.$node.remove(),this.data&&this.data.on([a.a.EVENT_ADD_COLUMN+".pool",a.a.EVENT_REMOVE_COLUMN+".pool","addRanking.pool","removeRanking.pool","addDesc.pool"],null)},t.prototype.update=function(){var t=this,e=this.data,i=this.entries.filter(function(t){return 0===t.used}).map(function(t){return t.desc}),a=this.$node.selectAll("div.header").data(i),c=a.enter().append("div").attr({class:"header",draggable:!0}).on("dragstart",function(t){var i=r.event;i.dataTransfer.effectAllowed="copyMove",i.dataTransfer.setData("text/plain",t.label),i.dataTransfer.setData("application/caleydo-lineup-column",JSON.stringify(e.toDescRef(t))),n.i(o.isNumberColumn)(t)&&i.dataTransfer.setData("application/caleydo-lineup-column-number",JSON.stringify(e.toDescRef(t)))}).style({width:this.options.elemWidth+"px",height:this.options.elemHeight+"px"});switch(this.options.addAtEndOnClick&&c.on("click",function(e){t.data.push(t.data.getLastRanking(),e)}),c.append("span").classed("label",!0).text(function(t){return t.label}),a.attr("class",function(t){return"header "+(t.cssClass||"")+" "+t.type}),a.style({transform:function(e,n){var r=t.layout(n);return"translate("+r.x+"px,"+r.y+"px)"},"background-color":function(t){var e=t;return e.cssClass?null:e.color||o.Column.DEFAULT_COLOR}}),a.attr({title:function(t){return n.i(s.a)(t)}}),a.select("span").text(function(t){return t.label}),a.exit().remove(),this.options.layout){case"horizontal":this.$node.style({width:this.options.elemWidth*i.length+"px",height:this.options.elemHeight+"px"});break;case"grid":var l=n.i(r.round)(this.options.width/this.options.elemWidth,0);this.$node.style({width:l*this.options.elemWidth+"px",height:Math.ceil(i.length/l)*this.options.elemHeight+"px"});break;default:this.$node.style({width:this.options.elemWidth+"px",height:this.options.elemHeight*i.length+"px"})}},t.prototype.layout=function(t){switch(this.options.layout){case"horizontal":return{x:t*this.options.elemWidth,y:0};case"grid":var e=n.i(r.round)(this.options.width/this.options.elemWidth,0);return{x:t%e*this.options.elemWidth,y:Math.floor(t/e)*this.options.elemHeight};default:return{x:0,y:t*this.options.elemHeight}}},t}();e.a=l},function(t,e,n){"use strict";var r=n(0),i=(n.n(r),n(6)),o=n(24),a=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},s={svg:{root:"svg",g:"g",setSize:function(t,e,n){t.setAttribute("width",String(e)),t.setAttribute("height",String(n))},bg:"rect",updateBG:function(t,e){t.attr({height:function(t,n,r){return e(t,n,r)[1]},width:function(t,n,r){return e(t,n,r)[0]}})},meanLine:"line",updateMeanLine:function(t,e,n){t.attr("x1",1+e).attr("x2",1+e).attr("y2",n)},slopes:"g",updateSlopes:function(t,e,n,r){t.attr("transform",function(t,e){return"translate("+r(t,e)+",0)"})},creator:i.createSVG,translate:function(t,e,n){return t.setAttribute("transform","translate("+e+","+n+")")},transform:function(t,e){t.attr("transform",function(t,n){var r=e(t,n);return"translate("+r[0]+","+r[1]+")"})}}},c=function(t){function e(e,n,r,i){return void 0===i&&(i={}),t.call(this,e,n,r,s.svg,i)||this}return a(e,t),e.prototype.updateClipPathsImpl=function(t,e,n){var r=this.$node.select("defs.body");r.empty()&&(r=this.$node.append("defs").classed("body",!0));var i=r.selectAll(function(){return this.getElementsByTagName("clipPath")}).data(t,function(t){return t.id});i.enter().append("clipPath").attr("id",function(t){return"cp"+e.idPrefix+"clipCol"+t.id}).append("rect").attr("y",0),i.exit().remove(),i.select("rect").attr({x:0,width:function(t){return Math.max(t.getWidth()-5,0)},height:n})},e.prototype.updateClipPaths=function(t,e,i){var o=this,a=[],s=0;t.forEach(function(t){var e=t.ranking.flatten(a,s,2,o.options.columnPadding);s+=e+o.options.slopeWidth}),this.updateClipPathsImpl(a.map(function(t){return t.col}),e,i);var c=this.$node.select("clipPath#c"+e.idPrefix+"Freeze");c.empty()&&(c=this.$node.append("clipPath").attr("id","c"+e.idPrefix+"Freeze").append("rect").attr({y:0,width:2e4,height:i}));var l=0===t.length||0===t[0].frozen.length?0:n.i(r.max)(t[0].frozen,function(t){return t.shift+t.column.getWidth()});c.select("rect").attr({x:l,height:i,transform:"translate("+this.currentFreezeLeft+",0)"})},e}(o.a);e.a=c},function(t,e,n){"use strict";var r=n(7);n.d(e,"DataProvider",function(){return r.a}),n.d(e,"IDataProviderOptions",function(){return r.IDataProviderOptions}),n.d(e,"IExportOptions",function(){return r.IExportOptions}),Object.defineProperty(e,"__esModule",{value:!0});var i=n(30);n.d(e,"LocalDataProvider",function(){return i.a}),n.d(e,"ILocalDataProviderOptions",function(){return i.ILocalDataProviderOptions});var o=n(43);n.d(e,"RemoteDataProvider",function(){return o.a}),n.d(e,"IServerData",function(){return o.IServerData})},,function(t,e,n){"use strict";var r=n(2),i=n(29),o=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},a=function(t){function e(e,i,o){void 0===i&&(i=[]),void 0===o&&(o={});var a=t.call(this,i,o)||this;return a.server=e,a.options={maxCacheSize:1e3},a.cache=new Map,n.i(r.merge)(a.options,o),a}return o(e,t),e.prototype.sortImpl=function(t){var e=t.toSortingDesc(function(t){return t.column});return this.server.sort(e)},e.prototype.loadFromServer=function(t){return this.server.view(t).then(function(e){return e.map(function(e,n){var r=t[n];return{v:e,dataIndex:r}})})},e.prototype.view=function(t){if(0===t.length)return Promise.resolve([]);var e=this.fetch([t])[0];return Promise.all(e).then(function(t){return t.map(function(t){return t.v})})},e.prototype.computeMissing=function(t){var e=new Set,n=e.add.bind(e);t.forEach(function(t){return t.forEach(n)}),this.cache.forEach(function(t,n){return e.delete(n)}),this.cache.size+e.size>this.options.maxCacheSize;var r=[];return e.forEach(r.push.bind(r)),r},e.prototype.loadInCache=function(t){var e=this;if(0!==t.length){var n=this.loadFromServer(t);t.forEach(function(r,i){var o=t[i];e.cache.set(o,n.then(function(t){return{v:t[i],dataIndex:o}}))})}},e.prototype.fetch=function(t){var e=this,n=this.computeMissing(t);return this.loadInCache(n),t.map(function(t){return t.map(function(t){return e.cache.get(t)})})},e.prototype.mappingSample=function(t){return this.server.mappingSample(t.desc.column)},e.prototype.searchAndJump=function(t,e){var n=this;this.server.search(t,e.desc.column).then(function(t){n.jumpToNearest(t)})},e.prototype.stats=function(t){return this.server.stats(t)},e}(i.a);e.a=a},function(t,e,n){"use strict";function r(t,e,n){return void 0===n&&(n={}),new s.LocalDataProvider(t,e,n)}function i(t,e,n){return void 0===n&&(n={}),new h.b(e,t,n)}var o=n(28),a=(n.n(o),n(10)),s=n(41),c=n(6),l=n(26),u=n(2),p=n(27),h=n(18);Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"deriveColors",function(){return h.a}),n.d(e,"model",function(){return d}),n.d(e,"provider",function(){return f}),n.d(e,"renderer",function(){return g}),n.d(e,"ui",function(){return E}),n.d(e,"utils",function(){return v}),n.d(e,"ui_dialogs",function(){return y}),e.createLocalStorage=r,e.create=i;var d=a,f=s,g=c,E=l,v=u,y=p}])});